# æ’ä»¶æ‰§è¡Œç¤ºä¾‹ï¼šå´å§“ç”·å­©å–åå®Œæ•´è®¡ç®—è¿‡ç¨‹

## ğŸ“‹ è¾“å…¥ä¿¡æ¯

**ç”¨æˆ·è¾“å…¥**ï¼š
- å§“æ°ï¼šå´
- æ€§åˆ«ï¼šç”·
- å‡ºç”Ÿæ—¶é—´ï¼š2025-10-31 10:00:00
- å®¶æ—ä¼ ç»Ÿï¼šæ— ç‰¹æ®Šè¦æ±‚

**ç¡®å®šæ€§ç­‰çº§**ï¼šLevel 1 (FULLY_DETERMINED) - å¯ç”¨å…¨éƒ¨æ’ä»¶

---

## ğŸ—ï¸ Layer 1: åŸºç¡€ä¿¡æ¯å±‚æ‰§è¡Œ

### 1.1 SurnamePlugin (å§“æ°åˆ†ææ’ä»¶)

**ğŸ“¥ è¾“å…¥**ï¼š
```json
{
  "familyName": "å´"
}
```

**ğŸ”„ è®¡ç®—è¿‡ç¨‹**ï¼š
```typescript
// ç¬¬ä¸€æ­¥ï¼šæŸ¥è¯¢ä¸»æ•°æ®åº“ (æœ€æƒå¨æ¥æº)
æŸ¥è¯¢æ–‡ä»¶: public/data/characters/final-enhanced-character-database.json
æŸ¥è¯¢è·¯å¾„: enhancedData["å´"]

ğŸ” å®é™…æŸ¥è¯¢ç»“æœ (ç¬¬17284-17303è¡Œ):
{
  "å´": {
    "char": "å´",
    "pinyin": ["wÃº"],
    "primaryPinyin": "wÃº",
    "tone": 2,
    "strokes": {
      "simplified": 7,
      "traditional": 7,
      "kangxi": 7
    },
    "radical": "å£",
    "wuxing": "mu",
    "simplified": "å´",
    "meanings": [",è±¡å¤´çš„åŠ¨ä½œã€‚åˆèµ·æ¥è¡¨ç¤ºæ™ƒç€å¤´å¤§å£°è¯´è¯ã€‚æœ¬ä¹‰:å¤§å£°è¯´è¯,å–§å“—) åŒæœ¬ä¹‰"],
    "isStandard": true,
    "traditional": "å³"
  }
}

// ç¬¬äºŒæ­¥ï¼šæ•°æ®æå–ä¸éªŒè¯
ç®€ä½“å­—: "å´"
ç¹ä½“å­—: "å³"
æ‹¼éŸ³: "wÃº" (ä» primaryPinyin è·å–)
å£°è°ƒ: 2 (é˜³å¹³)
ç®€ä½“ç¬”ç”»: 7ç”»
ç¹ä½“ç¬”ç”»: 7ç”» (åº·ç†™å­—å…¸ç¬”ç”»ï¼Œç”¨äºåç»­è®¡ç®—)
äº”è¡Œå±æ€§: "mu" (æœ¨)
éƒ¨é¦–: "å£"
å­—ä¹‰: "è±¡å¤´çš„åŠ¨ä½œï¼Œå¤§å£°è¯´è¯"

// ç¬¬ä¸‰æ­¥ï¼šFallbackæœºåˆ¶ (å¦‚æœä¸»æ•°æ®åº“ç¼ºå¤±ä¿¡æ¯)
å¦‚æœ final-enhanced-character-database.json ä¸­æŸé¡¹ä¸ºç©ºï¼Œåˆ™ï¼š
- æ‹¼éŸ³ç¼ºå¤± â†’ æŸ¥è¯¢ pinyin-processed.json
- ç¬”ç”»ç¼ºå¤± â†’ æŸ¥è¯¢ real-stroke-data.json  
- äº”è¡Œç¼ºå¤± â†’ æŸ¥è¯¢ wuxing_dict_jianti.json
- å£°è°ƒç¼ºå¤± â†’ ä» pinyin-processed.json ä¸­è·å–

// ç¬¬å››æ­¥ï¼šç™¾å®¶å§“æ’åæŸ¥è¯¢
æŸ¥è¯¢æ–‡ä»¶: public/data/names/baijiaxing.json
æŸ¥è¯¢è·¯å¾„: paragraphs[0]

ğŸ” å®é™…æŸ¥è¯¢è¿‡ç¨‹:
ç¬¬6è¡Œå†…å®¹: "èµµé’±å­™æï¼Œå‘¨å´éƒ‘ç‹ã€‚"
ä½ç½®è®¡ç®—æ–¹æ³•:
  cleanText = "èµµé’±å­™æå‘¨å´éƒ‘ç‹" (ç§»é™¤æ ‡ç‚¹)
  éå†å­—ç¬¦: èµµ(1) é’±(2) å­™(3) æ(4) å‘¨(5) å´(6) éƒ‘(7) ç‹(8)
  æ‰¾åˆ°"å´"å­—ä½ç½®: ç¬¬6ä½

éªŒè¯æ•°æ®æº:
  baijiaxing.jsonç¬¬6è¡Œç¡®å®åŒ…å«"å´"å­—
  ä¼ ç»Ÿç™¾å®¶å§“é¡ºåº: "èµµé’±å­™æï¼Œå‘¨å´éƒ‘ç‹"
  ç™¾å®¶å§“æ’å: ç¬¬6ä½ âœ“

// ç¬¬äº”æ­¥ï¼šè®¡ç®—è¡ç”Ÿæ•°æ®
å¤©æ ¼è®¡ç®—: 
- ä½¿ç”¨ç¹ä½“ç¬”ç”»æ•°: 7ç”»
- å¤©æ ¼ = 7 + 1 = 8 (å•å§“è§„åˆ™)

å­—ç¬¦ç±»å‹åˆ¤æ–­:
- å•å­—å§“: true (å­—ç¬¦é•¿åº¦ = 1)
- å¤å§“: false
- æ ‡å‡†å­—: true (isStandard = true)
```

**ğŸ“¤ è¾“å‡º**ï¼š
```json
{
  "familyName": "å´",
  "traditional": "å³",
  "simplified": "å´",
  "strokes": 7,
  "strokesTraditional": 7,
  "strokesKangxi": 7,
  "wuxing": "mu",
  "pinyin": ["wÃº"],
  "primaryPinyin": "wÃº", 
  "tone": 2,
  "radical": "å£",
  "meanings": ["è±¡å¤´çš„åŠ¨ä½œã€‚åˆèµ·æ¥è¡¨ç¤ºæ™ƒç€å¤´å¤§å£°è¯´è¯ã€‚æœ¬ä¹‰:å¤§å£°è¯´è¯,å–§å“—"],
  "isSingleChar": true,
  "isCompoundSurname": false,
  "isStandard": true,
  "baijiaxingRank": 6,
  "confidence": 1.0,
  "tianGeBase": 8,
  "dataSource": "final-enhanced-character-database"
}
```

---

### 1.2 GenderPlugin (æ€§åˆ«åå¥½åˆ†ææ’ä»¶)

**ğŸ“¥ è¾“å…¥**ï¼š
```json
{
  "gender": "male"
}
```

**ğŸ”„ ç®€åŒ–åçš„è®¡ç®—è¿‡ç¨‹**ï¼š
```typescript
// ç¬¬ä¸€æ­¥ï¼šæ€§åˆ«æ ‡è¯†éªŒè¯
è¾“å…¥éªŒè¯:
  gender = "male" âœ“ (æœ‰æ•ˆå€¼: "male" | "female")

// ç¬¬äºŒæ­¥ï¼šç¡®å®šå…¸ç±æ¥æºä¼˜å…ˆçº§ (ç”·æ¥šè¾å¥³è¯—ç»)
function getLiterarySourcePriority(gender: string) {
  if (gender === "male") {
    return {
      "æ¥šè¾": 0.9,      // ç”·æ¥šè¾ï¼Œé«˜ä¼˜å…ˆçº§
      "è®ºè¯­": 0.85,     // å„’å®¶ç»å…¸ï¼Œé€‚åˆç”·æ€§
      "æ˜“ç»": 0.8,      // å“²å­¦æ·±åº¦ï¼Œç”·æ€§åå¥½
      "è¯—ç»": 0.3,      // å¥³è¯—ç»ï¼Œä½ä¼˜å…ˆçº§
      "å®‹è¯": 0.6       // ä¸­ç­‰ä¼˜å…ˆçº§
    };
  } else {
    return {
      "è¯—ç»": 0.9,      // å¥³è¯—ç»ï¼Œé«˜ä¼˜å…ˆçº§  
      "å®‹è¯": 0.85,     // è¯éŸµä¼˜ç¾ï¼Œé€‚åˆå¥³æ€§
      "æ¥šè¾": 0.3,      // ç”·æ¥šè¾ï¼Œä½ä¼˜å…ˆçº§
      "è®ºè¯­": 0.6,      // ä¸­ç­‰ä¼˜å…ˆçº§
      "æ˜“ç»": 0.5       // è¾ƒä½ä¼˜å…ˆçº§
    };
  }
}

// ç¬¬ä¸‰æ­¥ï¼šè®¾ç½®å­—ç¬¦è¿‡æ»¤åå¥½
function getCharacterFilter(gender: string) {
  if (gender === "male") {
    return {
      preferMasculine: true,     // åå¥½é˜³åˆšç‰¹è´¨çš„å­—ç¬¦
      avoidFeminine: true,       // é¿å…è¿‡äºæŸ”ç¾çš„å­—ç¬¦
      culturalDepth: 0.9         // é«˜åº¦åå¥½æœ‰æ–‡åŒ–å†…æ¶µçš„å­—ç¬¦
    };
  } else {
    return {
      preferMasculine: false,    // ä¸ç‰¹åˆ«åå¥½é˜³åˆšç‰¹è´¨
      avoidFeminine: false,      // ä¸é¿å…æŸ”ç¾å­—ç¬¦
      culturalDepth: 0.9         // åŒæ ·åå¥½æœ‰æ–‡åŒ–å†…æ¶µçš„å­—ç¬¦
    };
  }
}

// ç¬¬å››æ­¥ï¼šæ‰§è¡Œè®¡ç®—
const literaryPriority = getLiterarySourcePriority("male");
const characterFilter = getCharacterFilter("male");

// è®¡ç®—ç»“æœ
literarySourcePriority = {
  "æ¥šè¾": 0.9,
  "è®ºè¯­": 0.85,
  "æ˜“ç»": 0.8,
  "è¯—ç»": 0.3,
  "å®‹è¯": 0.6
};

characterFilter = {
  preferMasculine: true,
  avoidFeminine: true,
  culturalDepth: 0.9
};
```

## âš ï¸ **è®¾è®¡é—®é¢˜åˆ†æä¸ä¿®æ­£**

**é—®é¢˜å‘ç°**ï¼šæ‚¨æŒ‡å‡ºçš„é—®é¢˜éå¸¸å‡†ç¡®ï¼åŸå§‹è®¾è®¡ä¸­å®šä¹‰äº†å¤§é‡è¯¦ç»†é…ç½®ï¼ˆcharacterPreferencesã€semanticFieldsã€culturalTraitsã€namingStyleï¼‰ï¼Œä½†åœ¨å½“å‰å…­å±‚æ¶æ„ä¸­**ç¼ºä¹æ˜ç¡®çš„ä½¿ç”¨åœºæ™¯**ï¼Œè¿™æ˜¯å…¸å‹çš„è¿‡åº¦è®¾è®¡é—®é¢˜ã€‚

### **ğŸ”„ é‡æ–°è®¾è®¡çš„ GenderPlugin è¾“å‡º**

**ğŸ“¤ ç®€åŒ–åçš„å®ç”¨è¾“å‡º**ï¼š
```json
{
  "gender": "male",
  "literarySourcePriority": {
    "æ¥šè¾": 0.9,      // åœ¨ Layer 4 PoetryPlugin ä¸­ä½¿ç”¨
    "è®ºè¯­": 0.85,
    "æ˜“ç»": 0.8,
    "è¯—ç»": 0.3,
    "å®‹è¯": 0.6
  },
  "characterFilter": {
    "preferMasculine": true,     // åœ¨ Layer 4 å­—ç¬¦ç­›é€‰æ—¶ä½¿ç”¨
    "avoidFeminine": true,       // é¿å…è¿‡äºæŸ”ç¾çš„å­—ç¬¦
    "culturalDepth": 0.9         // åå¥½æœ‰æ–‡åŒ–å†…æ¶µçš„å­—ç¬¦
  },
  "confidence": 1.0
}
```

### **ğŸ“ æ˜ç¡®çš„ä½¿ç”¨åœºæ™¯è¯´æ˜**

#### **1. literarySourcePriority ä½¿ç”¨åœºæ™¯**
```typescript
// Layer 4: PoetryPlugin (è¯—è¯å…¸ç±é€‰å­—æ’ä»¶) - å¦‚æœå­˜åœ¨
class PoetryPlugin {
  execute(context: any) {
    const genderPref = context.genderInfo.literarySourcePriority;
    
    // æ ¹æ®æ€§åˆ«åå¥½é€‰æ‹©å…¸ç±æ¥æº
    const selectedSource = this.selectHighestPrioritySource(genderPref);
    // "æ¥šè¾": 0.9 â†’ ä¼˜å…ˆä»æ¥šè¾ä¸­é€‰å­—
    
    return this.extractCharactersFromSource(selectedSource);
  }
}
```

#### **2. characterFilter ä½¿ç”¨åœºæ™¯**
```typescript
// Layer 4: WuxingCharPlugin (äº”è¡Œå­—ç¬¦ç­›é€‰æ’ä»¶)
class WuxingCharPlugin {
  filterCharactersByGender(characters: Character[], genderFilter: any) {
    return characters.filter(char => {
      // åº”ç”¨æ€§åˆ«è¿‡æ»¤è§„åˆ™
      if (genderFilter.preferMasculine && this.isMasculineChar(char)) {
        return true;
      }
      if (genderFilter.avoidFeminine && this.isFeminineChar(char)) {
        return false;
      }
      return this.evaluateCharacterFit(char, genderFilter.culturalDepth);
    });
  }
}
```


```

---

### 1.3 BirthTimePlugin (å‡ºç”Ÿæ—¶é—´åˆ†ææ’ä»¶)

**ğŸ“¥ è¾“å…¥**ï¼š
```json
{
  "birthInfo": {
    "year": 2025,
    "month": 10,
    "day": 31,
    "hour": 10,
    "minute": 0
  }
}
```

**ğŸ”„ è¯¦ç»†è®¡ç®—è¿‡ç¨‹**ï¼š
```typescript
// ç¬¬ä¸€æ­¥ï¼šè¾“å…¥éªŒè¯å’Œæ ‡å‡†åŒ–
è¾“å…¥éªŒè¯:
  year: 2025 âœ“ (èŒƒå›´: 1900-2100)
  month: 10 âœ“ (èŒƒå›´: 1-12)
  day: 31 âœ“ (è¯¥æœˆæœ‰æ•ˆæ—¥æœŸ)
  hour: 10 âœ“ (èŒƒå›´: 0-23)
  minute: 0 âœ“ (èŒƒå›´: 0-59)

æ—¶é—´ç±»å‹ç¡®å®š: "exact" (ç²¾ç¡®æ—¶é—´æ¨¡å¼)
ç½®ä¿¡åº¦: 1.0 (å®Œæ•´æ—¶é—´ä¿¡æ¯)

// ç¬¬äºŒæ­¥ï¼šå…¬å†è½¬å†œå†è®¡ç®—
æŸ¥è¯¢æ–‡ä»¶: public/data/calendar/lunar-calendar-2025.json (å‡è®¾)
æˆ–ä½¿ç”¨å†œå†è½¬æ¢ç®—æ³•:

function solarToLunar(year: number, month: number, day: number) {
  // åŸºäºä¸­ç§‘é™¢ç´«é‡‘å±±å¤©æ–‡å°å†æ³•
  const lunarData = getLunarCalendarData(year);
  
  // è®¡ç®—ä»æ˜¥èŠ‚å¼€å§‹çš„å¤©æ•°
  const springFestival = lunarData.springFestival; // 2025å¹´æ˜¥èŠ‚æ—¥æœŸ
  const daysSinceSpringFestival = daysBetween(springFestival, new Date(year, month-1, day));
  
  // æ ¹æ®å†œå†æœˆä»½å¤§å°è®¡ç®—å†œå†æ—¥æœŸ
  const lunarMonths = lunarData.months; // [30, 29, 30, 29, ...] å¤§å°æœˆä¿¡æ¯
  let lunarMonth = 1;
  let lunarDay = daysSinceSpringFestival;
  
  // é€æœˆå‡å»å¤©æ•°
  for (const monthDays of lunarMonths) {
    if (lunarDay <= monthDays) break;
    lunarDay -= monthDays;
    lunarMonth++;
  }
  
  return {
    year: year,
    month: lunarMonth,
    day: lunarDay,
    isLeapMonth: false // æ¶¦æœˆåˆ¤æ–­é€»è¾‘
  };
}

// 2025-10-31 è½¬æ¢ç»“æœ:
å†œå†ç»“æœ: {
  year: 2025,
  month: 9,        // å†œå†ä¹æœˆ
  day: 9,          // åˆä¹æ—¥
  monthName: "ä¹æœˆ",
  dayName: "åˆä¹",
  isLeapMonth: false
}

// ç¬¬ä¸‰æ­¥ï¼šå¹²æ”¯çºªå¹´è®¡ç®—
function calculateGanZhi(year: number) {
  // ç”²å­çºªå¹´èµ·å§‹å¹´ä»½ (å…¬å…ƒ4å¹´ä¸ºç”²å­å¹´)
  const baseYear = 4;
  const yearOffset = (year - baseYear) % 60;
  
  const tianGan = ["ç”²", "ä¹™", "ä¸™", "ä¸", "æˆŠ", "å·±", "åºš", "è¾›", "å£¬", "ç™¸"];
  const diZhi = ["å­", "ä¸‘", "å¯…", "å¯", "è¾°", "å·³", "åˆ", "æœª", "ç”³", "é…‰", "æˆŒ", "äº¥"];
  
  const ganIndex = yearOffset % 10;
  const zhiIndex = yearOffset % 12;
  
  return tianGan[ganIndex] + diZhi[zhiIndex];
}

// 2025å¹´è®¡ç®—:
yearGanZhi = calculateGanZhi(2025) = "ä¹™å·³"

// ç¬¬å››æ­¥ï¼šç”Ÿè‚–ç¡®å®š
function getZodiac(year: number): string {
  const zodiacAnimals = ["é¼ ", "ç‰›", "è™", "å…”", "é¾™", "è›‡", "é©¬", "ç¾Š", "çŒ´", "é¸¡", "ç‹—", "çŒª"];
  // ç”Ÿè‚–ä»¥å†œå†å¹´ä¸ºå‡†ï¼Œ2025å¹´ä¸ºè›‡å¹´
  const zodiacIndex = (year - 4) % 12; // å…¬å…ƒ4å¹´ä¸ºç”²å­é¼ å¹´
  return zodiacAnimals[zodiacIndex];
}

zodiac = getZodiac(2025) = "è›‡"

// ç¬¬äº”æ­¥ï¼šèŠ‚æ°”å’Œå­£èŠ‚åˆ†æ
æŸ¥è¯¢æ–‡ä»¶: public/data/calendar/solar-terms-2025.json
æˆ–ä½¿ç”¨èŠ‚æ°”è®¡ç®—ç®—æ³•:

const solarTerms2025 = {
  "å¯’éœ²": new Date(2025, 9, 8),   // 10æœˆ8æ—¥
  "éœœé™": new Date(2025, 9, 23),  // 10æœˆ23æ—¥  
  "ç«‹å†¬": new Date(2025, 10, 7),  // 11æœˆ7æ—¥
  "å°é›ª": new Date(2025, 10, 22)  // 11æœˆ22æ—¥
};

// 10æœˆ31æ—¥ä½ç½®åˆ†æ:
å½“å‰æ—¥æœŸ: 2025-10-31
å‰ä¸€èŠ‚æ°”: éœœé™ (10æœˆ23æ—¥)
åä¸€èŠ‚æ°”: ç«‹å†¬ (11æœˆ7æ—¥)
å­£èŠ‚çŠ¶æ€: æ·±ç§‹ï¼Œæ¥è¿‘ç«‹å†¬

å­£èŠ‚ç‰¹å¾åˆ†æ:
{
  season: "æ·±ç§‹",
  characteristics: ["é‡‘æ—º", "åœŸç›¸", "æœ¨ä¼‘", "ç«å›š", "æ°´æ­»"],
  energyTrend: "é˜³æ°”æ”¶æ•›ï¼Œé˜´æ°”æ¸ç››",
  climaticFeature: "ç‡¥æ°”å½“ä»¤ï¼Œéœ€è¦æ¶¦æ³½"
}

// ç¬¬å…­æ­¥ï¼šæ—¶è¾°åˆ†æ
function analyzeHour(hour: number) {
  const timeSegments = [
    { range: [23, 1], name: "å­æ—¶", element: "æ°´", energy: "é˜´æ°”æœ€ç››" },
    { range: [1, 3], name: "ä¸‘æ—¶", element: "åœŸ", energy: "é˜´æ°”æ¸é€€" },
    { range: [3, 5], name: "å¯…æ—¶", element: "æœ¨", energy: "é˜³æ°”åˆç”Ÿ" },
    { range: [5, 7], name: "å¯æ—¶", element: "æœ¨", energy: "é˜³æ°”æ¸ç››" },
    { range: [7, 9], name: "è¾°æ—¶", element: "åœŸ", energy: "é˜³æ°”ä¸Šå‡" },
    { range: [9, 11], name: "å·³æ—¶", element: "ç«", energy: "é˜³æ°”æ—ºç››" },
    { range: [11, 13], name: "åˆæ—¶", element: "ç«", energy: "é˜³æ°”æœ€ç››" },
    { range: [13, 15], name: "æœªæ—¶", element: "åœŸ", energy: "é˜³æ°”æ¸é€€" },
    { range: [15, 17], name: "ç”³æ—¶", element: "é‡‘", energy: "é˜´æ°”åˆç”Ÿ" },
    { range: [17, 19], name: "é…‰æ—¶", element: "é‡‘", energy: "é˜´æ°”æ¸ç››" },
    { range: [19, 21], name: "æˆŒæ—¶", element: "åœŸ", energy: "é˜´æ°”ä¸Šå‡" },
    { range: [21, 23], name: "äº¥æ—¶", element: "æ°´", energy: "é˜´æ°”æ—ºç››" }
  ];
  
  for (const segment of timeSegments) {
    const [start, end] = segment.range;
    if ((start <= end && hour >= start && hour < end) ||
        (start > end && (hour >= start || hour < end))) {
      return segment;
    }
  }
}

// 10:00 æ—¶è¾°åˆ†æ:
timeAnalysis = {
  hourName: "å·³æ—¶",
  timeRange: "09:00-11:00",
  element: "ç«",
  energy: "é˜³æ°”æ—ºç››",
  characteristics: ["ç«æ—ºæ—¶æ®µ", "ç²¾ç¥é¥±æ»¡", "æ´»åŠ›å……æ²›"],
  influence: "æœ‰åˆ©äºäº‹ä¸šå‘å±•ï¼Œæ€§æ ¼ç§¯æå‘ä¸Š"
}

// ç¬¬ä¸ƒæ­¥ï¼šç¡®å®šæ€§ç­‰çº§è¯„ä¼°
function assessCertaintyLevel(birthInfo: any) {
  if (birthInfo.hour !== undefined && birthInfo.minute !== undefined) {
    return {
      level: 1, // FULLY_DETERMINED
      description: "å®Œå…¨ç¡®å®š",
      confidence: 1.0,
      availableAnalysis: ["å…«å­—å››æŸ±", "æ—¶è¾°åˆ†æ", "ç²¾ç¡®ç”Ÿè‚–", "èŠ‚æ°”å½±å“"]
    };
  } else if (birthInfo.day !== undefined) {
    return {
      level: 2, // PARTIALLY_DETERMINED  
      description: "éƒ¨åˆ†ç¡®å®š",
      confidence: 0.8,
      availableAnalysis: ["ç®€åŒ–å…«å­—", "æ—¥æœŸç”Ÿè‚–", "å­£èŠ‚åˆ†æ"]
    };
  } else {
    return {
      level: 3, // ESTIMATED
      description: "é¢„ä¼°é˜¶æ®µ", 
      confidence: 0.6,
      availableAnalysis: ["å¹´ä»½ç”Ÿè‚–", "å­£èŠ‚æ¨æµ‹"]
    };
  }
}

certaintyLevel = assessCertaintyLevel(birthInfo) = {
  level: 1,
  description: "å®Œå…¨ç¡®å®š",
  confidence: 1.0,
  availableAnalysis: ["å…«å­—å››æŸ±", "æ—¶è¾°åˆ†æ", "ç²¾ç¡®ç”Ÿè‚–", "èŠ‚æ°”å½±å“"]
}
```

**ğŸ“¤ è¾“å‡º**ï¼š
```json
{
  "timeInfo": {
    "type": "exact",
    "year": 2025,
    "month": 10,
    "day": 31,
    "hour": 10,
    "minute": 0,
    "confidence": 1.0
  },
  "lunarInfo": {
    "year": "ä¹™å·³",
    "month": "ä¹æœˆ",
    "day": "åˆä¹",
    "time": "å·³æ—¶"
  },
  "zodiacInfo": {
    "primary": "è›‡",
    "probability": 1.0
  },
  "seasonInfo": {
    "season": "ç§‹å­£",
    "characteristics": ["é‡‘æ—º", "ç‡¥æ°”é‡", "éœ€è¦æ°´æ¶¦"]
  },
  "certaintyLevel": 1
}
```

---

## ğŸ§® Layer 2: å‘½ç†åˆ†æå±‚æ‰§è¡Œ

### 2.1 BaZiPlugin (å…«å­—å››æŸ±è®¡ç®—æ’ä»¶)

**ğŸ“¥ ä¾èµ–**ï¼šBirthTimePlugin ç»“æœ

**ğŸ”„ è®¡ç®—è¿‡ç¨‹**ï¼š
```typescript
å…«å­—å››æŸ±è®¡ç®—:
// å¹´æŸ±è®¡ç®—
2025å¹´ = ç”²å­çºªå¹´ç¬¬42å¹´ = ä¹™å·³å¹´
å¹´æŸ±: ä¹™å·³ (ä¹™æœ¨å·³ç«)

// æœˆæŸ±è®¡ç®—  
å†œå†ä¹æœˆ = æˆŒæœˆ, 2025å¹´ä¹™å¹´, æœˆæŸ±å¤©å¹² = ä¸™
æœˆæŸ±: ä¸™æˆŒ (ä¸™ç«æˆŒåœŸ)

// æ—¥æŸ±è®¡ç®— (éœ€è¦ä¸‡å¹´å†)
2025-10-31 = æˆŠå­æ—¥ (æˆŠåœŸå­æ°´)

// æ—¶æŸ±è®¡ç®—
å·³æ—¶ + æˆŠæ—¥ = ä¸å·³æ—¶ (ä¸ç«å·³ç«)

// äº”è¡Œç»Ÿè®¡
å…«å­—: ä¹™å·³ ä¸™æˆŒ æˆŠå­ ä¸å·³
æœ¨: 1ä¸ª (ä¹™)
ç«: 4ä¸ª (å·³, ä¸™, ä¸, å·³) 
åœŸ: 2ä¸ª (æˆŒ, æˆŠ)
é‡‘: 0ä¸ª
æ°´: 1ä¸ª (å­)

// æ—¥ä¸»åˆ†æ
æ—¥ä¸»: æˆŠåœŸ
ç”ŸäºæˆŒæœˆ: åœŸæ—ºä¹‹æ—¶
ç«å¤šåœŸç‡¥: éœ€è¦é‡‘æ°´è°ƒå€™
```

**ğŸ“¤ è¾“å‡º**ï¼š
```json
{
  "fourPillars": {
    "year": {"heavenStem": "ä¹™", "earthBranch": "å·³", "wuxing": "æœ¨ç«"},
    "month": {"heavenStem": "ä¸™", "earthBranch": "æˆŒ", "wuxing": "ç«åœŸ"},
    "day": {"heavenStem": "æˆŠ", "earthBranch": "å­", "wuxing": "åœŸæ°´"},
    "hour": {"heavenStem": "ä¸", "earthBranch": "å·³", "wuxing": "ç«ç«"}
  },
  "dayMaster": "æˆŠåœŸ",
  "dayMasterWuxing": "åœŸ",
  "strongWeak": "å¼º",
  "wuxingCount": {"jin": 0, "mu": 1, "shui": 1, "huo": 4, "tu": 2},
  "analysisQuality": "precise",
  "confidence": 0.95
}
```

---

### 2.2 XiYongShenPlugin (äº”è¡Œå–œç”¨ç¥åˆ†ææ’ä»¶)

**ğŸ“¥ ä¾èµ–**ï¼šBaZiPlugin ç»“æœ

**ğŸ”„ è®¡ç®—è¿‡ç¨‹**ï¼š
```typescript
å–œç”¨ç¥åˆ†æ:
// æ—¥ä¸»å¼ºå¼±åˆ¤æ–­
æ—¥ä¸»æˆŠåœŸ: ç”ŸäºæˆŒæœˆ (åœŸæ—ºæœˆ)
åœ°æ”¯æœ‰æˆŒåœŸæ ¹: æ—¥ä¸»åå¼º
å¤©å¹²ç«å¤šç”ŸåœŸ: æ—¥ä¸»æ›´å¼º

// ç—…è¯åˆ†æ
ä¸»è¦é—®é¢˜: ç«å¤šåœŸç‡¥, ç¼ºé‡‘ç¼ºæ°´
ç«: 4ä¸ª (è¿‡æ—º, é€ æˆç‡¥çƒ­)
é‡‘: 0ä¸ª (ç¼ºå¤±, æ— æ³•æ³„åœŸç”Ÿæ°´)
æ°´: 1ä¸ª (åå¼±, æ— æ³•æ¶¦åœŸ)

// ç”¨ç¥ç¡®å®š
é¦–é€‰ç”¨ç¥: é‡‘ (æ³„åœŸç”Ÿæ°´, è°ƒå€™æ¶¦ç‡¥)
æ¬¡é€‰ç”¨ç¥: æ°´ (æ¶¦åœŸ, è°ƒå€™)
å¿Œç¥: ç«åœŸ (åŠ é‡ç‡¥çƒ­å¤±è¡¡)
```

**ğŸ“¤ è¾“å‡º**ï¼š
```json
{
  "analysis": {
    "dayMaster": "æˆŠåœŸ",
    "dayMasterWuxing": "åœŸ", 
    "strongWeak": "åå¼º",
    "seasonInfluence": "åœŸæ—ºç«å¤š, ç‡¥çƒ­å¤±è¡¡",
    "xiShen": ["é‡‘", "æ°´"],
    "yongShen": ["é‡‘"],
    "jiShen": ["ç«", "åœŸ"],
    "confidence": 0.9,
    "method": "æ‰¶æŠ‘ç”¨ç¥æ³•"
  },
  "recommendations": {
    "primaryElements": ["é‡‘"],
    "secondaryElements": ["æ°´"],
    "avoidElements": ["ç«", "åœŸ"],
    "balanceStrategy": "é‡‘æ°´è°ƒå€™æ¶¦ç‡¥",
    "priority": [
      {"element": "é‡‘", "priority": 95, "reason": "æ³„åœŸç”Ÿæ°´è°ƒå€™"},
      {"element": "æ°´", "priority": 85, "reason": "æ¶¦åœŸè§£ç‡¥"}
    ]
  }
}
```

---

### 2.3 ZodiacPlugin (ç”Ÿè‚–ç‰¹æ€§åˆ†ææ’ä»¶)

**ğŸ“¥ ä¾èµ–**ï¼šBirthTimePlugin ç»“æœ

**ğŸ”„ è®¡ç®—è¿‡ç¨‹**ï¼š
```typescript
ç”Ÿè‚–è›‡çš„ç‰¹æ€§åˆ†æ:
// åŸºæœ¬ç‰¹å¾
æ€§æ ¼: æ™ºæ…§ã€è°¨æ…ã€ç¥ç§˜ã€ä¼˜é›…
ä¼˜åŠ¿: ç›´è§‰æ•é”ã€æ€è€ƒæ·±é‚ƒã€å¤„äº‹å†·é™
è±¡å¾: æ™ºæ…§ä¹‹ç¥ã€åŒ»è¯ä¹‹ç¥

// ç”Ÿæ´»ä¹ æ€§å¯¹åº”çš„ç”¨å­—è§„å¾‹
å–œç”¨ç¯å¢ƒ:
- æ´ç©´å±…ä½ â†’ å–œ"å£"ã€"å®€"ã€"å†–"ç­‰å­—æ ¹
- æ ‘æ—æ –æ¯ â†’ å–œ"æœ¨"ã€"æ—"ã€"æ£®"ç­‰å­—æ ¹  
- å¤œé—´æ´»åŠ¨ â†’ å–œ"æœˆ"å­—æ ¹
- é£Ÿè‰é£Ÿè‚‰ â†’ å–œ"ç¦¾"ã€"è±†"ã€"è‚‰"ç­‰å­—æ ¹

å¿Œç”¨ç¯å¢ƒ:
- æ€•æ—¥å…‰æš´æ™’ â†’ å¿Œ"æ—¥"ã€"å…‰"ã€"æ˜"ç­‰å­—æ ¹
- é¿å¼€å¹³åŸ â†’ å¿Œ"ç”°"ã€"å¹³"ç­‰å­—æ ¹
- ä¸è™ç›¸å†² â†’ å¿Œ"è™"ã€"å½ª"ç­‰å­—æ ¹
```

**ğŸ“¤ è¾“å‡º**ï¼š
```json
{
  "primaryZodiac": "è›‡",
  "characteristics": {
    "personality": ["æ™ºæ…§", "è°¨æ…", "ç¥ç§˜", "ä¼˜é›…"],
    "strengths": ["ç›´è§‰æ•é”", "æ€è€ƒæ·±é‚ƒ", "å¤„äº‹å†·é™"],
    "luckyElements": ["é‡‘", "æ°´", "æœ¨"]
  },
  "selectionRules": {
    "preferredRadicals": ["å£", "å®€", "å†–", "æœ¨", "æ—", "ç¦¾", "æœˆ"],
    "avoidedRadicals": ["æ—¥", "å…‰", "ç”°", "è™", "è±•"],
    "preferredCharacters": ["å®¸", "å®", "å›", "å“²", "æ—", "æ£®"],
    "avoidedCharacters": ["æ˜", "æ˜Œ", "æ™¨", "è™", "å½ª"],
    "selectionPrinciples": ["å–œæ´ç©´æ –æ¯", "å–œæ ‘æ—ç¯å¢ƒ", "é¿æ—¥å…‰æš´æ™’"],
    "riskFactors": ["ä¸çŒªç›¸å®³", "ä¸è™ç›¸å†²"]
  }
}
```

---

## ğŸ¯ Layer 3: é€‰å­—ç­–ç•¥å±‚æ‰§è¡Œ

### 3.1 WuxingSelectionPlugin (äº”è¡Œé€‰å­—ç­–ç•¥æ’ä»¶)

**ğŸ“¥ ä¾èµ–**ï¼šXiYongShenPlugin ç»“æœ

**ğŸ”„ è®¡ç®—è¿‡ç¨‹**ï¼š
```typescript
äº”è¡Œé€‰å­—ç­–ç•¥åˆ¶å®š:
// åŸºäºå–œç”¨ç¥åˆ†æç»“æœ
ä¸»é€‰äº”è¡Œ: é‡‘ (æƒé‡40%, ä¼˜å…ˆçº§95åˆ†)
æ¬¡é€‰äº”è¡Œ: æ°´ (æƒé‡35%, ä¼˜å…ˆçº§85åˆ†)  
å¯é€‰äº”è¡Œ: æœ¨ (æƒé‡25%, ä¼˜å…ˆçº§70åˆ†)
é¿å…äº”è¡Œ: ç«åœŸ (æƒé‡0%, ä¼˜å…ˆçº§0åˆ†)

// å…·ä½“å­—ç¬¦ç­›é€‰æ ‡å‡†
é‡‘äº”è¡Œå­—ç¬¦: 
  - éƒ¨é¦–: é‡‘é’…ã€åˆ€åˆ‚ã€æˆˆç­‰
  - å­—ä¾‹: é“­(14ç”»)ã€é”¦(16ç”»)ã€é’¦(9ç”»)ã€é”(12ç”»)ã€é’¢(9ç”»)
  
æ°´äº”è¡Œå­—ç¬¦:
  - éƒ¨é¦–: æ°´æ°µã€é›¨ã€å†«ç­‰  
  - å­—ä¾‹: æ¶¦(16ç”»)ã€æ³½(17ç”»)ã€æ¶µ(12ç”»)ã€æ·³(12ç”»)ã€æ¾„(16ç”»)
```

**ğŸ“¤ è¾“å‡º**ï¼š
```json
{
  "selectionStrategy": {
    "primaryWuxing": ["é‡‘"],
    "secondaryWuxing": ["æ°´"],
    "avoidWuxing": ["ç«", "åœŸ"],
    "balanceApproach": "é‡‘æ°´è°ƒå€™æ¶¦ç‡¥"
  },
  "characterCriteria": [
    {
      "wuxing": "é‡‘",
      "priority": 95,
      "weight": 0.4,
      "reasons": ["æ³„åœŸç”Ÿæ°´", "è°ƒå€™æ¶¦ç‡¥", "å¹³è¡¡å‘½å±€"],
      "targetCount": 1
    },
    {
      "wuxing": "æ°´", 
      "priority": 85,
      "weight": 0.35,
      "reasons": ["æ¶¦åœŸè§£ç‡¥", "è°ƒå’Œå‘½å±€"],
      "targetCount": 1
    }
  ],
  "filterRules": {
    "mustHave": ["é‡‘"],
    "mustAvoid": ["ç«", "åœŸ"],
    "preferredRatio": {"é‡‘": 0.4, "æ°´": 0.35, "æœ¨": 0.25}
  }
}
```

---

### 3.2 ZodiacSelectionPlugin (ç”Ÿè‚–é€‰å­—ç­–ç•¥æ’ä»¶)

**ğŸ“¥ ä¾èµ–**ï¼šZodiacPlugin ç»“æœ

**ğŸ”„ è®¡ç®—è¿‡ç¨‹**ï¼š
```typescript
ç”Ÿè‚–è›‡é€‰å­—ç­–ç•¥:
// æ ¹æ®è›‡çš„ç”Ÿæ´»ä¹ æ€§åˆ¶å®šé€‰å­—è§„åˆ™
ç­–ç•¥åŸåˆ™: 
1. ä¼˜é€‰æœ‰åˆ©ç¯å¢ƒå­—æ ¹ (æ´ç©´ã€æ ‘æ—)
2. é¿å…ä¸åˆ©ç¯å¢ƒå­—æ ¹ (æ—¥å…‰ã€å¹³åŸ)  
3. è€ƒè™‘ç›¸å†²ç›¸å®³å…³ç³»

æƒé‡è®¾ç½®:
- å¼ºçƒˆæ¨èå­—ç¬¦: +2åˆ† (å¦‚: å®¸ã€å›ã€å“²)
- ä¸€èˆ¬æ¨èå­—ç¬¦: +1åˆ† (å¦‚: æ—ã€æ£®ã€å¯)
- ä¸­æ€§å­—ç¬¦: 0åˆ†
- ä¸æ¨èå­—ç¬¦: -1åˆ† (å¦‚: æ˜ã€æ˜Œ)
- å¼ºçƒˆé¿å…å­—ç¬¦: -3åˆ† (å¦‚: è™ã€è±•)
```

**ğŸ“¤ è¾“å‡º**ï¼š
```json
{
  "selectionStrategy": {
    "approachType": "ä¼ ç»Ÿç”Ÿè‚–é…å­—æ³•",
    "riskTolerance": 0.8,
    "traditionLevel": 0.9
  },
  "characterCriteria": {
    "highlyRecommended": {
      "characters": ["å®¸", "å®", "å›", "å“²", "å¯"],
      "radicals": ["å®€", "å£", "å£"],
      "reasons": ["æ´ç©´æ –æ¯ç¯å¢ƒ", "æ™ºæ…§è±¡å¾"],
      "weight": 2.0
    },
    "recommended": {
      "characters": ["æ—", "æ£®", "æŸ", "æ¾"],
      "radicals": ["æœ¨", "æ—"],
      "reasons": ["æ ‘æ—æ –æ¯ç¯å¢ƒ"],
      "weight": 1.0
    },
    "discouraged": {
      "characters": ["æ˜", "æ˜Œ", "æ™¨", "é˜³"],
      "radicals": ["æ—¥", "å…‰"],
      "reasons": ["æ—¥å…‰æš´æ™’ä¸åˆ©"],
      "penalty": -1.0
    },
    "forbidden": {
      "characters": ["è™", "å½ª", "è±•"],
      "radicals": ["è™", "è±•"],
      "reasons": ["ç›¸å†²ç›¸å®³"]
    }
  }
}
```

---

### 3.3 MeaningSelectionPlugin (å¯“æ„é€‰å­—ç­–ç•¥æ’ä»¶)

**ğŸ“¥ ä¾èµ–**ï¼šGenderPlugin ç»“æœ

**ğŸ”„ è®¡ç®—è¿‡ç¨‹**ï¼š
```typescript
ç”·æ€§å¯“æ„é€‰å­—ç­–ç•¥:
// åŸºäºæ€§åˆ«åå¥½ç¡®å®šå¯“æ„æ–¹å‘
æ ¸å¿ƒå¯“æ„ç±»åˆ«:
1. æ™ºæ…§æ‰å: å“²ã€ç¿ã€æ…§ã€èªã€æ•
2. å“å¾·ä¿®å…»: å¾·ã€ä»ã€ä¹‰ã€è¯šã€è°¦  
3. å¿—å‘æŠ±è´Ÿ: å¿—ã€ç¿”ã€è¿œã€åšã€å®
4. è‡ªç„¶å±±æ°´: æ³½ã€æ—ã€å³°ã€å·ã€æµ·

æ–‡åŒ–æ·±åº¦è¦æ±‚:
- è¯—ç»å‡ºå¤„: ä¼˜å…ˆé€‰æ‹©è¯—ç»ä¸­çš„ç”¨å­—
- è®ºè¯­å…¸æ•…: ä½“ç°å„’å®¶æ–‡åŒ–å†…æ¶µ
- ç°ä»£é€‚ç”¨: æ˜“è¯»æ˜“å†™ï¼Œå›½é™…åŒ–å‹å¥½

è¯„åˆ†æ ‡å‡†:
- ç§¯æå¯“æ„: 85-100åˆ†
- æ–‡åŒ–å†…æ¶µ: 80-95åˆ†  
- ç°ä»£é€‚ç”¨: 75-90åˆ†
- æ€§åˆ«é€‚å®œ: 90-100åˆ†
```

**ğŸ“¤ è¾“å‡º**ï¼š
```json
{
  "selectionStrategy": {
    "culturalDepth": 0.85,
    "modernRelevance": 0.8,
    "uniquenessLevel": 0.75,
    "genderSpecificity": 0.9
  },
  "semanticCriteria": {
    "preferredSemantics": [
      {
        "category": "æ™ºæ…§æ‰å",
        "keywords": ["æ™ºæ…§", "èªæ˜", "æ‰å", "ç¿æ™º"],
        "priority": 95,
        "examples": ["å“²", "ç¿", "æ…§", "èª"]
      },
      {
        "category": "å“å¾·ä¿®å…»", 
        "keywords": ["å“å¾·", "ä»ä¹‰", "è¯šä¿¡", "è°¦é€Š"],
        "priority": 90,
        "examples": ["å¾·", "ä»", "è¯š", "è°¦"]
      }
    ]
  },
  "culturalCriteria": {
    "literarySources": ["è¯—ç»", "è®ºè¯­", "æ˜“ç»"],
    "culturalSymbols": ["é¾™å‡¤", "å±±æ°´", "æ—¥æœˆ"],
    "traditionalValues": ["ä»ä¹‰ç¤¼æ™ºä¿¡"]
  }
}
```

---

### 3.4 StrokeSelectionPlugin (ç¬”ç”»é€‰å­—ç­–ç•¥æ’ä»¶)

**ğŸ“¥ ä¾èµ–**ï¼šSurnamePlugin ç»“æœ

**ğŸ”„ è®¡ç®—è¿‡ç¨‹**ï¼š
```typescript
ç¬”ç”»ç»„åˆç­–ç•¥åˆ†æ:
// åŸºç¡€ä¿¡æ¯
å§“æ°: å´ (7ç”»)
å¤©æ ¼: 8 (7+1)

// äº”æ ¼è®¡ç®—å…¬å¼
å¤©æ ¼ = å§“æ°ç¬”ç”» + 1 (å•å§“)
äººæ ¼ = å§“æ°ç¬”ç”» + åå­—ç¬¬ä¸€å­—ç¬”ç”»  
åœ°æ ¼ = åå­—ç¬¬ä¸€å­—ç¬”ç”» + åå­—ç¬¬äºŒå­—ç¬”ç”»
å¤–æ ¼ = æ€»æ ¼ - äººæ ¼ + 1
æ€»æ ¼ = å§“æ°ç¬”ç”» + åå­—ç¬¬ä¸€å­—ç¬”ç”» + åå­—ç¬¬äºŒå­—ç¬”ç”»

// æœ€ä½³ç¬”ç”»ç»„åˆåˆ†æ
ç»„åˆ1: 7-9-16
  å¤©æ ¼: 8 (å‰)
  äººæ ¼: 16 (å¤§å‰) 
  åœ°æ ¼: 25 (å¤§å‰)
  å¤–æ ¼: 17 (å¤§å‰)
  æ€»æ ¼: 32 (å¤§å‰)
  è¯„åˆ†: 95åˆ†

ç»„åˆ2: 7-11-14  
  å¤©æ ¼: 8 (å‰)
  äººæ ¼: 18 (å¤§å‰)
  åœ°æ ¼: 25 (å¤§å‰) 
  å¤–æ ¼: 15 (å¤§å‰)
  æ€»æ ¼: 32 (å¤§å‰)
  è¯„åˆ†: 92åˆ†
```

**ğŸ“¤ è¾“å‡º**ï¼š
```json
{
  "surnameInfo": {
    "familyNameStrokes": 7,
    "isSingleSurname": true,
    "tianGeBase": 8
  },
  "strokeCombinations": [
    {
      "firstCharStrokes": 9,
      "secondCharStrokes": 16,
      "sancaiCombination": "é‡‘åœŸåœŸ",
      "wugeAnalysis": {
        "tianGe": {"value": 8, "luck": "å‰"},
        "renGe": {"value": 16, "luck": "å¤§å‰"},
        "diGe": {"value": 25, "luck": "å¤§å‰"},
        "waiGe": {"value": 17, "luck": "å¤§å‰"},
        "zongGe": {"value": 32, "luck": "å¤§å‰"}
      },
      "overallScore": 95,
      "priority": 1
    }
  ],
  "recommendations": {
    "bestCombinations": [[9, 16], [11, 14]],
    "goodCombinations": [[7, 18], [13, 12]],
    "avoidCombinations": [[10, 10], [4, 20]]
  }
}
```

---

## ğŸ” Layer 4: å­—ç¬¦ç­›é€‰å±‚æ‰§è¡Œ

### 4.1 CharacterFilterPlugin (ç»¼åˆå­—ç¬¦ç­›é€‰æ’ä»¶)

**ğŸ“¥ ä¾èµ–**ï¼šLayer 3 æ‰€æœ‰ç­–ç•¥æ’ä»¶ç»“æœ

**ğŸ”„ è®¡ç®—è¿‡ç¨‹**ï¼š
```typescript
ç»¼åˆç­›é€‰åˆ†æ:
// ç­›é€‰æ¡ä»¶æ±‡æ€»
1. äº”è¡Œè¦æ±‚: é‡‘(ä¼˜å…ˆ)ã€æ°´(æ¬¡é€‰)
2. ç”Ÿè‚–è¦æ±‚: è›‡å–œå­—æ ¹, é¿å…å¿Œç”¨å­—æ ¹
3. å¯“æ„è¦æ±‚: æ™ºæ…§å“å¾·ç±», ç”·æ€§é€‚å®œ
4. ç¬”ç”»è¦æ±‚: 9ç”»ã€16ç”»ç»„åˆä¼˜å…ˆ

ç¬¬ä¸€å­—ç­›é€‰ (9ç”»):
æ­¥éª¤1: ç¬”ç”»ç­›é€‰
- æŸ¥è¯¢æ–‡ä»¶: public/data/characters/real-stroke-data.json
- ç­›é€‰æ¡ä»¶: strokes == 9
- åˆå§‹å€™é€‰: 1000+ä¸ª9ç”»å­—ç¬¦

æ­¥éª¤2: äº”è¡Œç­›é€‰ (é‡‘æ°´äº”è¡Œ)
- æŸ¥è¯¢æ–‡ä»¶: public/data/characters/wuxing_dict_jianti.json
- ç­›é€‰é‡‘äº”è¡Œå­—ç¬¦: ä»"jin"åˆ†ç±»ä¸‹çš„"9"ç¬”ç”»æ•°ç»„ä¸­è·å–
- ç­›é€‰æ°´äº”è¡Œå­—ç¬¦: ä»"shui"åˆ†ç±»ä¸‹çš„"9"ç¬”ç”»æ•°ç»„ä¸­è·å–
- é‡‘äº”è¡Œ9ç”»å€™é€‰: ["é’¦", "é’¢", "é’§", "é’¦", "é’ˆ"...]
- æ°´äº”è¡Œ9ç”»å€™é€‰: ["æ³‰", "æ³³", "æ³½", "æ´‹", "æ´ª"...]
- åˆå¹¶ç»“æœ: 200+ä¸ªå­—ç¬¦

æ­¥éª¤3: ç”Ÿè‚–ç­›é€‰ (è›‡å–œå­—æ ¹)
- åŸºäºZodiacPluginç»“æœ: å–œ"å£"ã€"å®€"ã€"æœ¨"ç­‰å­—æ ¹
- å­—æ ¹åŒ¹é…ç®—æ³•: æ£€æŸ¥å­—ç¬¦ç»“æ„æ˜¯å¦åŒ…å«å–œç”¨å­—æ ¹
- ç­›é€‰ç»“æœ: 80+ä¸ªå­—ç¬¦

æ­¥éª¤4: å¯“æ„ç­›é€‰ (ç§¯ææ­£é¢)
- åŸºäºMeaningPluginçš„è¯­ä¹‰åˆ†æ
- ç­›é€‰æ ‡å‡†: ç§¯æå¯“æ„ã€æ–‡åŒ–å†…æ¶µã€æ€§åˆ«é€‚å®œ
- æœ€ç»ˆå€™é€‰: 15ä¸ªé«˜è´¨é‡å­—ç¬¦

ç¬¬äºŒå­—ç­›é€‰ (16ç”»):
æ­¥éª¤1: ç¬”ç”»ç­›é€‰
- æŸ¥è¯¢æ–‡ä»¶: public/data/characters/real-stroke-data.json
- ç­›é€‰æ¡ä»¶: strokes == 16
- åˆå§‹å€™é€‰: 800+ä¸ª16ç”»å­—ç¬¦

æ­¥éª¤2: äº”è¡Œç­›é€‰ (é‡‘æ°´äº”è¡Œ)
- æŸ¥è¯¢æ–‡ä»¶: public/data/characters/wuxing_dict_jianti.json
- é‡‘äº”è¡Œ16ç”»å€™é€‰: ["é”¦", "é’±", "é“­", "é”", "é’¢"...]
- æ°´äº”è¡Œ16ç”»å€™é€‰: ["æ¶¦", "æ¾„", "æ½®", "æ¿®", "æ¾"...]
- åˆå¹¶ç»“æœ: 150+ä¸ªå­—ç¬¦

æ­¥éª¤3-4: ç”Ÿè‚–å’Œå¯“æ„ç­›é€‰
- æœ€ç»ˆå€™é€‰: 12ä¸ªé«˜è´¨é‡å­—ç¬¦

å…·ä½“è¯„åˆ†è®¡ç®—:
å­—ç¬¦"é’¦" (9ç”»):
- äº”è¡Œè¯„åˆ†: 95 (é‡‘äº”è¡Œï¼Œå®Œå…¨ç¬¦åˆ)
- ç”Ÿè‚–è¯„åˆ†: 75 (é‡‘å­—æ—ï¼Œä¸­æ€§)
- å¯“æ„è¯„åˆ†: 85 (æ­æ•¬ã€é’¦ä½©ï¼Œç§¯æ)
- ç¬”ç”»è¯„åˆ†: 95 (9ç”»ï¼Œå®Œå…¨åŒ¹é…)
- ç»¼åˆè¯„åˆ†: 87.5

å­—ç¬¦"æ¶¦" (16ç”»):  
- äº”è¡Œè¯„åˆ†: 95 (æ°´äº”è¡Œï¼Œç¬¦åˆæ¬¡é€‰)
- ç”Ÿè‚–è¯„åˆ†: 80 (æ°´æ¶¦ï¼Œè›‡å–œ)
- å¯“æ„è¯„åˆ†: 88 (æ¶¦æ³½ã€æ»‹æ¶¦ï¼Œç§¯æ)
- ç¬”ç”»è¯„åˆ†: 95 (16ç”»ï¼Œå®Œå…¨åŒ¹é…)
- ç»¼åˆè¯„åˆ†: 89.5
```

**ğŸ“¤ è¾“å‡º**ï¼š
```json
{
  "candidatePool": {
    "firstCharCandidates": [
      {
        "character": "é’¦",
        "scores": {"wuxing": 95, "zodiac": 75, "meaning": 85, "stroke": 95, "overall": 87.5},
        "metadata": {"strokes": 9, "wuxing": "é‡‘", "meaning": "æ­æ•¬é’¦ä½©", "culturalLevel": 85}
      },
      {
        "character": "å®£", 
        "scores": {"wuxing": 85, "zodiac": 95, "meaning": 80, "stroke": 95, "overall": 88.75},
        "metadata": {"strokes": 9, "wuxing": "é‡‘", "meaning": "å®£æ‰¬ä¼ æ’­", "culturalLevel": 80}
      }
    ],
    "secondCharCandidates": [
      {
        "character": "æ¶¦",
        "scores": {"wuxing": 95, "zodiac": 80, "meaning": 88, "stroke": 95, "overall": 89.5},
        "metadata": {"strokes": 16, "wuxing": "æ°´", "meaning": "æ¶¦æ³½æ»‹æ¶¦", "culturalLevel": 85}
      },
      {
        "character": "é”¦",
        "scores": {"wuxing": 90, "zodiac": 75, "meaning": 90, "stroke": 95, "overall": 87.5},
        "metadata": {"strokes": 16, "wuxing": "é‡‘", "meaning": "é”¦ç»£å‰ç¨‹", "culturalLevel": 88}
      }
    ]
  },
  "filteringSummary": {
    "totalCandidates": 27,
    "qualityDistribution": {"ä¼˜ç§€": 8, "è‰¯å¥½": 12, "ä¸€èˆ¬": 7}
  }
}
```

---

## ğŸ¨ Layer 5: åå­—ç”Ÿæˆå±‚æ‰§è¡Œ

### 5.1 NameCombinationPlugin (åå­—ç»„åˆç”Ÿæˆæ’ä»¶)

**ğŸ“¥ ä¾èµ–**ï¼šCharacterFilterPlugin ç»“æœ

**ğŸ”„ è®¡ç®—è¿‡ç¨‹**ï¼š
```typescript
åå­—ç»„åˆç”Ÿæˆ:
// åŸºäºå€™é€‰å­—ç¬¦æ± è¿›è¡Œç»„åˆ
ç¬¬ä¸€å­—å€™é€‰: ["é’¦", "å®£", "æ³½", "å“²", "å®"]
ç¬¬äºŒå­—å€™é€‰: ["æ¶¦", "é”¦", "é“­", "æ¾„", "ç‘"]

ç»„åˆç­–ç•¥:
1. äº”è¡Œæ­é…: é‡‘+æ°´ > é‡‘+é‡‘ > æ°´+æ°´
2. éŸ³éŸµå’Œè°: é¿å…è¿ç»­ç›¸åŒå£°è°ƒ
3. å¯“æ„åè°ƒ: æ•´ä½“å¯“æ„è¦ç»Ÿä¸€
4. å­—å½¢ç¾è§‚: ç»“æ„æ­é…è¦å’Œè°

ç”Ÿæˆå€™é€‰åå­—:
1. å´é’¦æ¶¦ (é‡‘+æ°´)
2. å´å®£æ¶¦ (é‡‘+æ°´) 
3. å´é’¦é”¦ (é‡‘+é‡‘)
4. å´å®£é”¦ (é‡‘+é‡‘)
5. å´æ³½æ¶¦ (æ°´+æ°´)

åŸºç¡€è¯„ä¼° (ä¸å«è¯¦ç»†è¯„åˆ†):
- äº”è¡Œæ­é…åˆç†æ€§
- éŸ³éŸµåˆæ­¥å’Œè°åº¦  
- å¯“æ„åŸºæœ¬ç»Ÿä¸€æ€§
- å­—å½¢ç»“æ„ç¾è§‚åº¦
```

**ğŸ“¤ è¾“å‡º**ï¼š
```json
{
  "generatedNames": [
    {
      "fullName": "å´é’¦æ¶¦",
      "givenName": "é’¦æ¶¦", 
      "characters": ["é’¦", "æ¶¦"],
      "basicInfo": {
        "totalStrokes": 32,
        "wuxingCombination": ["æœ¨", "é‡‘", "æ°´"],
        "sourceScores": {"firstChar": 87.5, "secondChar": 89.5}
      },
      "generationMetadata": {
        "combinationRank": 2,
        "diversityScore": 85,
        "harmonyPotential": 90,
        "uniquenessLevel": 78
      }
    },
    {
      "fullName": "å´å®£æ¶¦",
      "givenName": "å®£æ¶¦",
      "characters": ["å®£", "æ¶¦"], 
      "basicInfo": {
        "totalStrokes": 32,
        "wuxingCombination": ["æœ¨", "é‡‘", "æ°´"],
        "sourceScores": {"firstChar": 88.75, "secondChar": 89.5}
      },
      "generationMetadata": {
        "combinationRank": 1,
        "diversityScore": 88,
        "harmonyPotential": 92,
        "uniquenessLevel": 80
      }
    }
  ],
  "generationSummary": {
    "totalCombinations": 25,
    "filteringCriteria": ["äº”è¡Œæ­é…", "éŸ³éŸµå’Œè°", "å¯“æ„ç»Ÿä¸€"],
    "processingTime": 120
  }
}
```

---

## ğŸ“Š Layer 6: åå­—è¯„åˆ†å±‚æ‰§è¡Œ

### 6.1 SancaiScoringPlugin (ä¸‰æ‰äº”æ ¼è¯„åˆ†æ’ä»¶)

**ğŸ“¥ ä¾èµ–**ï¼šNameCombinationPlugin ç»“æœ

**ğŸ”„ è®¡ç®—è¿‡ç¨‹ (ä»¥"å´å®£æ¶¦"ä¸ºä¾‹)**ï¼š
```typescript
ä¸‰æ‰äº”æ ¼è¯¦ç»†è®¡ç®—:
// åŸºç¡€ç¬”ç”»
å§“æ°: å´(7ç”»)
ç¬¬ä¸€å­—: å®£(9ç”»)  
ç¬¬äºŒå­—: æ¶¦(16ç”»)

// äº”æ ¼è®¡ç®—
å¤©æ ¼ = 7 + 1 = 8
äººæ ¼ = 7 + 9 = 16  
åœ°æ ¼ = 9 + 16 = 25
å¤–æ ¼ = 8 + 25 - 16 = 17
æ€»æ ¼ = 7 + 9 + 16 = 32

// äº”è¡Œå¯¹åº” (å°¾æ•°æ³•)
å¤©æ ¼8 â†’ é‡‘ (8,9ä¸ºé‡‘)
äººæ ¼16 â†’ åœŸ (6,7ä¸ºåœŸ) 
åœ°æ ¼25 â†’ åœŸ (5,6ä¸ºåœŸ)
å¤–æ ¼17 â†’ é‡‘ (7,8ä¸ºé‡‘)
æ€»æ ¼32 â†’ æœ¨ (1,2ä¸ºæœ¨)

// ä¸‰æ‰ç»„åˆ
å¤©æ‰: é‡‘
äººæ‰: åœŸ  
åœ°æ‰: åœŸ
ä¸‰æ‰ç»„åˆ: é‡‘åœŸåœŸ (é‡‘ç”ŸåœŸ, ç›¸ç”Ÿå‰åˆ©)

// æ•°ç†å‰å‡¶æŸ¥è¯¢
8: å‹¤å‹‰å‘å±•æ•° (å‰)
16: åšå¾·è½½ç‰©æ•° (å¤§å‰)
25: è‹±ä¿Šåˆšæ¯…æ•° (å¤§å‰) 
17: çªç ´ä¸‡éš¾æ•° (å¤§å‰)
32: ä¾¥å¹¸å¤šæœ›æ•° (å¤§å‰)
```

**ğŸ“¤ è¾“å‡º**ï¼š
```json
{
  "nameScores": [
    {
      "fullName": "å´å®£æ¶¦",
      "wugeAnalysis": {
        "tianGe": {"value": 8, "meaning": "å‹¤å‹‰å‘å±•", "luck": "å‰", "score": 80},
        "renGe": {"value": 16, "meaning": "åšå¾·è½½ç‰©", "luck": "å¤§å‰", "score": 95},
        "diGe": {"value": 25, "meaning": "è‹±ä¿Šåˆšæ¯…", "luck": "å¤§å‰", "score": 95},
        "waiGe": {"value": 17, "meaning": "çªç ´ä¸‡éš¾", "luck": "å¤§å‰", "score": 95},
        "zongGe": {"value": 32, "meaning": "ä¾¥å¹¸å¤šæœ›", "luck": "å¤§å‰", "score": 95}
      },
      "sancaiCombination": {
        "heaven": "é‡‘",
        "human": "åœŸ", 
        "earth": "åœŸ",
        "combination": "é‡‘åœŸåœŸ",
        "harmony": 90,
        "interpretation": "é‡‘ç”ŸåœŸï¼ŒåŸºç¡€ç¨³å›ºï¼Œå‘å±•é¡ºåˆ©",
        "score": 90
      },
      "overallSancaiScore": 92,
      "strengths": ["ä¸‰æ‰ç›¸ç”Ÿ", "äº”æ ¼ä¿±ä½³", "æ•°ç†å¤§å‰"],
      "weaknesses": ["äººåœ°åŒåœŸç•¥é‡"]
    }
  ]
}
```

---

### 6.2 PhoneticScoringPlugin (éŸ³éŸµç¾æ„Ÿè¯„åˆ†æ’ä»¶)

**ğŸ“¥ ä¾èµ–**ï¼šNameCombinationPlugin ç»“æœ

**ğŸ”„ è®¡ç®—è¿‡ç¨‹ (ä»¥"å´å®£æ¶¦"ä¸ºä¾‹)**ï¼š
```typescript
éŸ³éŸµç¾æ„Ÿåˆ†æ:
// æ‹¼éŸ³åˆ†æ
å´: wÃº (ç¬¬2å£°, é˜³å¹³)
å®£: xuÄn (ç¬¬1å£°, é˜´å¹³)  
æ¶¦: rÃ¹n (ç¬¬4å£°, å»å£°)

// å£°è°ƒç»„åˆ
å£°è°ƒæ¨¡å¼: 2-1-4 (é˜³å¹³-é˜´å¹³-å»å£°)
å£°è°ƒå˜åŒ–: é™-å‡-é™ (æœ‰èµ·ä¼ï¼Œè¾ƒå’Œè°)

// éŸ³éŸµç‰¹å¾åˆ†æ
1. å¤´éŸµ: æ— æ˜æ˜¾å¤´éŸµ
2. éŸµæ¯: Ãº-uÄn-Ã¹n (æœ‰ç›¸ä¼¼éŸ³ç´ , å’Œè°)
3. å£°æ¯: w-x-r (ä¸åŒå£°æ¯, é¿å…æ‹—å£)

// å‘éŸ³éš¾åº¦è¯„ä¼°
- å•å­—å‘éŸ³: éƒ½æ˜¯å¸¸ç”¨å­—, å‘éŸ³æ¸…æ™°
- è¿è¯»æµç•…: æ— æ˜æ˜¾é˜»æ»
- éŸ³èŠ‚é•¿åº¦: 1-2-1 (èŠ‚å¥é€‚ä¸­)

// éŸ³ä¹æ€§åˆ†æ
- éŸ³è°ƒèµ·ä¼: æœ‰å‡æœ‰é™, å¯Œæœ‰éŸµå¾‹
- éŸ³é•¿æ­é…: é•¿çŸ­ç›¸é—´, èŠ‚å¥æ„Ÿå¥½
- æ•´ä½“å’Œè°: 85åˆ†
```

**ğŸ“¤ è¾“å‡º**ï¼š
```json
{
  "nameScores": [
    {
      "fullName": "å´å®£æ¶¦",
      "phoneticAnalysis": {
        "pinyin": ["wÃº", "xuÄn", "rÃ¹n"],
        "tones": [2, 1, 4],
        "harmony": {
          "overallScore": 85,
          "tonePattern": "2-1-4",
          "toneHarmony": 85,
          "rhythmScore": 88
        },
        "pronunciation": {
          "difficulty": 20,
          "clarity": 95,
          "smoothness": 88,
          "memorability": 85
        },
        "aestheticFeatures": {
          "alliteration": false,
          "rhyme": "ç›¸ä¼¼éŸµæ¯",
          "rhythm": "æœ‰èµ·ä¼",
          "musicality": 85
        }
      },
      "overallPhoneticScore": 85,
      "highlights": ["å£°è°ƒæœ‰å˜åŒ–", "éŸµæ¯å’Œè°", "å‘éŸ³æ¸…æ™°"],
      "improvements": ["å¯è€ƒè™‘æ›´å¤šéŸ³éŸµå˜åŒ–"]
    }
  ]
}
```

---

### 6.3 WuxingBalanceScoringPlugin (äº”è¡Œå¹³è¡¡è¯„åˆ†æ’ä»¶)

**ğŸ“¥ ä¾èµ–**ï¼šNameCombinationPlugin + XiYongShenPlugin ç»“æœ

**ğŸ”„ è®¡ç®—è¿‡ç¨‹ (ä»¥"å´å®£æ¶¦"ä¸ºä¾‹)**ï¼š
```typescript
äº”è¡Œå¹³è¡¡åˆ†æ:
// å§“åäº”è¡Œåˆ†å¸ƒ
å§“æ°: å´(æœ¨)
ç¬¬ä¸€å­—: å®£(é‡‘)
ç¬¬äºŒå­—: æ¶¦(æ°´)
æ•´ä½“: æœ¨-é‡‘-æ°´

// äº”è¡Œå…³ç³»åˆ†æ
æœ¨ç”Ÿç«, ç«ç”ŸåœŸ, åœŸç”Ÿé‡‘, é‡‘ç”Ÿæ°´, æ°´ç”Ÿæœ¨
å½“å‰æµå‘: æœ¨â†’(ä¸ç›´æ¥ç›¸ç”Ÿ)â†’é‡‘â†’æ°´â†’æœ¨ (å½¢æˆå¾ªç¯)

// ä¸å…«å­—å–œç”¨ç¥å¯¹æ¯”
å…«å­—å–œç”¨ç¥: é‡‘ã€æ°´
åå­—äº”è¡Œ: é‡‘ã€æ°´ (å®Œå…¨ç¬¦åˆ)
ç¬¦åˆåº¦: 95%

// äº”è¡Œå¹³è¡¡è®¡ç®—
æœ¨: 1ä¸ª (å§“æ°)
é‡‘: 1ä¸ª (å®£)  
æ°´: 1ä¸ª (æ¶¦)
ç«: 0ä¸ª
åœŸ: 0ä¸ª

å¹³è¡¡çŠ¶æ€: ä¸‰è¡Œå¹¶é‡, ç¼ºç«åœŸ
ä¼˜åŠ¿: å®Œå…¨é¿å¼€å¿Œç¥ç«åœŸ
åŠ£åŠ¿: ç•¥æ˜¾å•è–„, ç¼ºä¹åœŸçš„ç¨³å®š

// èƒ½é‡æµåŠ¨åˆ†æ
æœ¨(å´) â†’ é‡‘(å®£): é‡‘å…‹æœ¨ (ç•¥å†²çª)
é‡‘(å®£) â†’ æ°´(æ¶¦): é‡‘ç”Ÿæ°´ (ç›¸ç”Ÿå’Œè°)
æ°´(æ¶¦) â†’ æœ¨(å´): æ°´ç”Ÿæœ¨ (å›å½’ç›¸ç”Ÿ)
æ•´ä½“è¯„ä»·: åŸºæœ¬å’Œè°, æœ‰è½»å¾®å†²çª
```

**ğŸ“¤ è¾“å‡º**ï¼š
```json
{
  "nameScores": [
    {
      "fullName": "å´å®£æ¶¦",
      "currentState": {
        "surnameWuxing": "æœ¨",
        "charactersWuxing": ["é‡‘", "æ°´"],
        "overallDistribution": {"æœ¨": 1, "é‡‘": 1, "æ°´": 1, "ç«": 0, "åœŸ": 0},
        "dominantElements": ["æœ¨", "é‡‘", "æ°´"],
        "weakElements": ["ç«", "åœŸ"]
      },
      "balanceAnalysis": {
        "harmonyScore": 88,
        "balanceType": "åé‡å‹", 
        "energyFlow": "é‡‘ç”Ÿæ°´ï¼Œæ°´ç”Ÿæœ¨ï¼ŒåŸºæœ¬æµé€š",
        "strengthAssessment": {"æœ¨": 60, "é‡‘": 80, "æ°´": 75, "ç«": 0, "åœŸ": 0},
        "relationalAnalysis": {
          "generateChain": ["é‡‘â†’æ°´", "æ°´â†’æœ¨"],
          "overcomeCycle": ["é‡‘â†’æœ¨"],
          "supportRelations": ["é‡‘æ°´ç›¸ç”Ÿ", "æ°´æœ¨ç›¸ç”Ÿ"],
          "conflictRelations": ["é‡‘æœ¨ç›¸å…‹"]
        }
      },
      "xiYongAlignment": {
        "complianceScore": 95,
        "deviations": ["è½»å¾®é‡‘å…‹æœ¨"],
        "alignmentLevel": "é«˜åº¦ç¬¦åˆ"
      },
      "overallWuxingScore": 88,
      "recommendations": ["å®Œç¾å¥‘åˆå–œç”¨ç¥", "é¿å¼€å¿Œç¥ç«åœŸ", "è½»å¾®é‡‘å…‹æœ¨å¯å¿½ç•¥"]
    }
  ]
}
```

---

### 6.4 DayanScoringPlugin (å¤§è¡æ•°ç†è¯„åˆ†æ’ä»¶)

**ğŸ“¥ ä¾èµ–**ï¼šNameCombinationPlugin + SancaiScoringPlugin ç»“æœ

**ğŸ”„ è®¡ç®—è¿‡ç¨‹ (ä»¥"å´å®£æ¶¦"ä¸ºä¾‹)**ï¼š
```typescript
81æ•°ç†å‰å‡¶åˆ†æ:
// åŸºäºä¸‰æ‰äº”æ ¼æ•°å€¼è¿›è¡Œ81æ•°ç†æŸ¥è¯¢
å¤©æ ¼8: å…«å¦ä¹‹æ•°ï¼Œåšåˆšä¸å±ˆ (åŠå‰)
äººæ ¼16: åšå¾·è½½ç‰©ï¼Œå®‰å¯Œå°Šè£ (å¤§å‰)
åœ°æ ¼25: èµ„æ€§è‹±æ•ï¼Œæ‰èƒ½å¥‡ç‰¹ (å¤§å‰)  
å¤–æ ¼17: çªç ´ä¸‡éš¾ï¼ŒåˆšæŸ”å…¼å¤‡ (å¤§å‰)
æ€»æ ¼32: æ± ä¸­ä¹‹é¾™ï¼Œé£äº‘é™…ä¼š (å¤§å‰)

// æ•°ç†å†…æ¶µè§£æ
16æ•°å†…æ¶µ:
- åŸºæœ¬å«ä¹‰: åšé‡å“å¾·ï¼Œè½½ç‰©åŒ…å®¹
- äººæ ¼ç‰¹å¾: æ¸©å’Œæ•¦åšï¼Œå“å¾·é«˜å°šï¼Œå—äººå°Šæ•¬
- äº‹ä¸šè¿åŠ¿: èƒ½è·ä¼—äººåŠ©åŠ›ï¼Œæˆå°±å¤§ä¸š
- äººé™…å…³ç³»: å¾·é«˜æœ›é‡ï¼Œäººç¼˜æä½³
- è´¢è¿: å› å¾·è€Œå¯Œï¼Œè´¢æºå¹¿è¿›

25æ•°å†…æ¶µ:  
- åŸºæœ¬å«ä¹‰: èµ„è´¨èªæ•ï¼Œä¸ªæ€§ç‹¬ç‰¹
- æ‰èƒ½ç‰¹ç‚¹: å¤©èµ‹å¼‚ç¦€ï¼Œæ‰åå‡ºä¼—
- å¤„äº‹æ–¹å¼: ç‹¬ç‰¹è§è§£ï¼Œä¸éšæ³¢é€æµ
- æˆåŠŸé€”å¾„: é æ‰èƒ½æ™ºæ…§è·å¾—æˆåŠŸ

// æ€§åˆ«é€‚å®œæ€§åˆ†æ (ç”·æ€§)
16æ•°: ç”·æ€§é€‚å®œåº¦95% (åšå¾·è½½ç‰©ï¼Œç”·æ€§ç‰¹è´¨)
25æ•°: ç”·æ€§é€‚å®œåº¦90% (åˆšæ¯…è‹±æ•ï¼Œç¬¦åˆç”·æ€§)
32æ•°: ç”·æ€§é€‚å®œåº¦92% (é¾™è…¾ä¹å¤©ï¼Œç”·æ€§è±¡å¾)
```

**ğŸ“¤ è¾“å‡º**ï¼š
```json
{
  "nameScores": [
    {
      "fullName": "å´å®£æ¶¦",
      "numberAnalysis": [
        {
          "position": "äººæ ¼",
          "number": 16,
          "interpretation": {
            "meaning": "åšå¾·è½½ç‰©ï¼Œå®‰å¯Œå°Šè£",
            "characteristics": ["å“å¾·é«˜å°š", "å—äººå°Šæ•¬", "å¾·é«˜æœ›é‡"],
            "fortune": "å¤§å‰",
            "genderSuitability": {"male": 95, "female": 85}
          },
          "detailedAnalysis": {
            "personality": ["æ¸©å’Œæ•¦åš", "åŒ…å®¹å¤§åº¦", "å“å¾·é«˜å°š"],
            "talents": ["é¢†å¯¼æ‰èƒ½", "é“å¾·ä¿®å…»", "äººé™…åè°ƒ"],
            "challenges": ["å¯èƒ½è¿‡äºä¿å®ˆ"],
            "lifeAspects": {
              "career": "èƒ½è·ä¼—äººåŠ©åŠ›ï¼Œæˆå°±å¤§ä¸š",
              "wealth": "å› å¾·è€Œå¯Œï¼Œè´¢æºç¨³å®š", 
              "health": "èº«å¿ƒå¥åº·ï¼Œé•¿å¯¿ä¹‹è±¡",
              "relationships": "äººç¼˜æä½³ï¼Œè´µäººç›¸åŠ©",
              "family": "å®¶åº­å’Œç¦ï¼Œå­å­™å…´æ—º"
            }
          },
          "score": 95
        }
      ],
      "overallDayanScore": 92,
      "balanceAnalysis": "æ•°ç†ç»„åˆä¼˜ç§€ï¼Œå‰å‡¶æ­é…åˆç†",
      "genderCompatibility": 93
    }
  ]
}
```

---

### 6.5 ComprehensiveScoringPlugin (ç»¼åˆè¯„åˆ†æ’åºæ’ä»¶)

**ğŸ“¥ ä¾èµ–**ï¼šLayer 6 æ‰€æœ‰è¯„åˆ†æ’ä»¶ç»“æœ

**ğŸ”„ è®¡ç®—è¿‡ç¨‹**ï¼š
```typescript
ç»¼åˆè¯„åˆ†è®¡ç®—:
// è¯„åˆ†æƒé‡è®¾ç½®
æƒé‡é…ç½®:
- ä¸‰æ‰äº”æ ¼: 25% (ä¼ ç»Ÿå‘½ç†æ ¸å¿ƒ)
- äº”è¡Œå¹³è¡¡: 25% (å…«å­—åŒ¹é…é‡è¦)  
- éŸ³éŸµç¾æ„Ÿ: 20% (ç°ä»£å–åé‡è§†)
- å¤§è¡æ•°ç†: 20% (æ•°ç†å‰å‡¶)
- ç”Ÿè‚–é€‚å®œ: 10% (ä¼ ç»Ÿä¹ ä¿—)

// "å´å®£æ¶¦"ç»¼åˆè®¡ç®—
åˆ†é¡¹å¾—åˆ†:
- ä¸‰æ‰äº”æ ¼: 92åˆ†
- äº”è¡Œå¹³è¡¡: 88åˆ†
- éŸ³éŸµç¾æ„Ÿ: 85åˆ†  
- å¤§è¡æ•°ç†: 92åˆ†
- ç”Ÿè‚–åŒ¹é…: 88åˆ†

åŠ æƒè®¡ç®—:
ç»¼åˆå¾—åˆ† = 92Ã—0.25 + 88Ã—0.25 + 85Ã—0.20 + 92Ã—0.20 + 88Ã—0.10
         = 23 + 22 + 17 + 18.4 + 8.8
         = 89.2åˆ†

// è´¨é‡ç­‰çº§è¯„å®š
90-100: å“è¶Š (excellent)
80-89: ä¼˜ç§€ (good)  
70-79: è‰¯å¥½ (average)
60-69: ä¸€èˆ¬ (fair)
<60: éœ€æ”¹è¿› (poor)

"å´å®£æ¶¦": 89.2åˆ† â†’ ä¼˜ç§€ç­‰çº§

// ç‰¹è‰²åˆ†æ
æ–‡åŒ–å†…æ¶µ: 95åˆ† (å®£æ‰¬æ¶¦æ³½ï¼Œå¯“æ„æ·±è¿œ)
ç°ä»£é€‚ç”¨: 88åˆ† (æ˜“è¯»æ˜“å†™ï¼Œå›½é™…å‹å¥½)
ç‹¬ç‰¹æ€§: 80åˆ† (ç»„åˆè¾ƒä¸ºç‹¬ç‰¹)
ä¼ ç»Ÿä»·å€¼: 92åˆ† (ç¬¦åˆä¼ ç»Ÿå–åç†å¿µ)
```

**ğŸ“¤ è¾“å‡º**ï¼š
```json
{
  "finalRecommendations": [
    {
      "fullName": "å´å®£æ¶¦",
      "scoreBreakdown": {
        "sancai": 92,
        "phonetic": 85,
        "wuxingBalance": 88,
        "dayan": 92,
        "zodiac": 88
      },
      "comprehensiveScore": 89.2,
      "weightedScore": 89.2,
      "qualityAssessment": {
        "level": "excellent",
        "confidence": 0.92,
        "uniqueness": 80,
        "traditionalValue": 92,
        "modernAppeal": 88
      },
      "analysisReport": {
        "strengths": [
          "ä¸‰æ‰äº”æ ¼ä¿±ä½³ï¼Œæ•°ç†å¤§å‰",
          "å®Œç¾å¥‘åˆå…«å­—å–œç”¨ç¥é‡‘æ°´",
          "å¯“æ„æ·±è¿œï¼Œå®£æ‰¬æ¶¦æ³½ï¼Œå“å¾·é«˜å°š",
          "éŸ³éŸµå’Œè°ï¼Œå‘éŸ³æ¸…æ™°",
          "ç”Ÿè‚–é€‚å®œï¼Œè›‡å–œé‡‘æ°´"
        ],
        "considerations": [
          "é‡‘å…‹æœ¨çš„è½»å¾®å†²çªå¯å¿½ç•¥",
          "éŸ³è°ƒå˜åŒ–å¯ä»¥æ›´ä¸°å¯Œ",
          "æ€»ä½“å¹³è¡¡æ€§ä¼˜ç§€"
        ],
        "culturalSignificance": "å®£æ‰¬ä¼ æ’­ä¸æ¶¦æ³½æ»‹å…»çš„ç»“åˆï¼Œä½“ç°æ—¢èƒ½å‘å£°åˆèƒ½åŒ…å®¹çš„å“æ ¼",
        "personalityImplications": [
          "å“å¾·é«˜å°šï¼Œå—äººå°Šæ•¬",
          "æ‰åå‡ºä¼—ï¼Œè§è§£ç‹¬ç‰¹", 
          "æ¸©å’ŒåŒ…å®¹ï¼Œäººé™…å’Œè°",
          "äº‹ä¸šæœ‰æˆï¼Œè´¢è¿ç¨³å®š"
        ],
        "lifeAspectPredictions": {
          "career": "èƒ½è·å¾—ä¼—äººåŠ©åŠ›ï¼Œåœ¨ä¼ æ’­ã€æ•™è‚²ã€æ–‡åŒ–é¢†åŸŸå®¹æ˜“æˆåŠŸ",
          "relationships": "äººç¼˜æä½³ï¼Œå¤šå¾—è´µäººç›¸åŠ©ï¼Œå©šå§»å¹¸ç¦",
          "health": "èº«å¿ƒå¥åº·ï¼Œæ°´æ¶¦é‡‘ç”Ÿï¼Œä½“è´¨è¾ƒå¥½",
          "wealth": "å› å¾·è€Œå¯Œï¼Œè´¢æºç¨³å®šï¼Œä¸ä¸ºé’±è´¢æ‰€å›°"
        }
      },
      "recommendations": {
        "usage": "éå¸¸é€‚åˆä½œä¸ºæ­£å¼å§“åä½¿ç”¨",
        "alternatives": ["å´é’¦æ¶¦", "å´å®£é”¦"],
        "enhancements": ["å¯é…åˆä¹¦æ³•ç»ƒä¹ å¢å¼ºæ–‡åŒ–æ°”è´¨"]
      },
      "rank": 1
    }
  ],
  "summaryReport": {
    "totalAnalyzed": 5,
    "recommendationCount": 3,
    "avgScore": 85.4,
    "scoreDistribution": {"ä¼˜ç§€": 2, "è‰¯å¥½": 2, "ä¸€èˆ¬": 1},
    "qualityDistribution": {"excellent": 1, "good": 2, "average": 2},
    "processingMetrics": {
      "totalProcessingTime": 2350,
      "pluginPerformance": {
        "Layer1": 180,
        "Layer2": 320, 
        "Layer3": 280,
        "Layer4": 200,
        "Layer5": 150,
        "Layer6": 1220
      }
    }
  }
}
```

---

## ğŸ† æœ€ç»ˆæ¨èç»“æœ

### æ¨èåå­—ï¼š**å´å®£æ¶¦**

**ç»¼åˆè¯„åˆ†ï¼š89.2åˆ† (ä¼˜ç§€ç­‰çº§)**

### ğŸ“Š è¯¦ç»†è¯„åˆ†æ˜ç»†

| è¯„åˆ†ç»´åº¦ | å¾—åˆ† | æƒé‡ | åŠ æƒåˆ† | è¯„ä»· |
|----------|------|------|--------|------|
| ä¸‰æ‰äº”æ ¼ | 92åˆ† | 25% | 23åˆ† | äº”æ ¼ä¿±ä½³ï¼Œæ•°ç†å¤§å‰ |
| äº”è¡Œå¹³è¡¡ | 88åˆ† | 25% | 22åˆ† | å®Œç¾å¥‘åˆå–œç”¨ç¥é‡‘æ°´ |
| éŸ³éŸµç¾æ„Ÿ | 85åˆ† | 20% | 17åˆ† | å£°è°ƒæœ‰å˜åŒ–ï¼Œå‘éŸ³æ¸…æ™° |
| å¤§è¡æ•°ç† | 92åˆ† | 20% | 18.4åˆ† | åšå¾·è½½ç‰©ï¼Œå®‰å¯Œå°Šè£ |
| ç”Ÿè‚–é€‚å®œ | 88åˆ† | 10% | 8.8åˆ† | è›‡å–œé‡‘æ°´ï¼ŒåŸºæœ¬é€‚å®œ |
| **æ€»è®¡** | **-** | **100%** | **89.2åˆ†** | **ä¼˜ç§€ç­‰çº§** |

### âœ¨ æ ¸å¿ƒä¼˜åŠ¿

1. **å‘½ç†åŒ¹é…åº¦æé«˜**
   - å…«å­—å–œç”¨ç¥ï¼šé‡‘ã€æ°´
   - åå­—äº”è¡Œï¼šé‡‘(å®£)ã€æ°´(æ¶¦)
   - åŒ¹é…åº¦ï¼š95%

2. **ä¸‰æ‰äº”æ ¼ä¿±ä½³**
   - äº”æ ¼æ•°ç†ï¼š8-16-25-17-32
   - å‰å‡¶è¯„ä»·ï¼š4ä¸ªå¤§å‰ï¼Œ1ä¸ªå‰
   - ä¸‰æ‰ç»„åˆï¼šé‡‘åœŸåœŸï¼Œç›¸ç”Ÿå’Œè°

3. **å¯“æ„æ·±è¿œç§¯æ**
   - å®£ï¼šå®£æ‰¬ã€ä¼ æ’­ã€å½°æ˜¾
   - æ¶¦ï¼šæ¶¦æ³½ã€æ»‹æ¶¦ã€æ©æƒ 
   - æ•´ä½“ï¼šæ—¢èƒ½å‘å£°ä¼ æ’­ï¼Œåˆèƒ½æ¶¦æ³½ä»–äºº

4. **ç°ä»£é€‚ç”¨æ€§å¼º**
   - å­—å½¢ï¼šç®€æ´ç¾è§‚ï¼Œæ˜“å†™æ˜“è®¤
   - è¯»éŸ³ï¼šwÃº xuÄn rÃ¹nï¼Œæœ—æœ—ä¸Šå£
   - å›½é™…åŒ–ï¼šæ‹¼éŸ³å‹å¥½ï¼Œä¾¿äºäº¤æµ

### ğŸ¯ ä¸ªæ€§ä¸è¿åŠ¿é¢„æµ‹

**æ€§æ ¼ç‰¹è´¨**ï¼š
- å“å¾·é«˜å°šï¼Œæ¸©å’Œæ•¦åš
- æ‰åå‡ºä¼—ï¼Œè§è§£ç‹¬ç‰¹
- åŒ…å®¹å¤§åº¦ï¼Œå–„äºè¡¨è¾¾
- å¾·æ‰å…¼å¤‡ï¼Œå—äººå°Šæ•¬

**äººç”Ÿè¿åŠ¿**ï¼š
- **äº‹ä¸š**ï¼šåœ¨ä¼ æ’­ã€æ•™è‚²ã€æ–‡åŒ–é¢†åŸŸå®¹æ˜“æˆåŠŸï¼Œèƒ½è·ä¼—äººåŠ©åŠ›
- **è´¢è¿**ï¼šå› å¾·è€Œå¯Œï¼Œè´¢æºç¨³å®šï¼Œä¸ä¸ºé’±è´¢æ‰€å›°
- **äººé™…**ï¼šäººç¼˜æä½³ï¼Œå¤šå¾—è´µäººç›¸åŠ©ï¼Œç¤¾äº¤èƒ½åŠ›å¼º
- **å¥åº·**ï¼šæ°´æ¶¦é‡‘ç”Ÿï¼Œèº«å¿ƒå¥åº·ï¼Œä½“è´¨è¾ƒå¥½
- **å©šå§»**ï¼šå“å¾·å—äººé’¦ä½©ï¼Œå©šå§»å¹¸ç¦ç¾æ»¡

### ğŸ“š æ–‡åŒ–å†…æ¶µè§£æ

**å­—ä¹‰æ·±åº¦åˆ†æ**ï¼š
- **å®£**ï¼šã€Šè¯´æ–‡è§£å­—ã€‹ï¼š"å®£ï¼Œå¤©å­å®£å¸ƒè¯ä»¤ä¹‹æ‰€ä¹Ÿ"ï¼Œæœ‰ä¼ æ’­ã€å½°æ˜¾ä¹‹æ„
- **æ¶¦**ï¼šã€Šè¯—ç»Â·è±³é£ã€‹ï¼š"æ¶¦ä¹‹ä»¥é£é›¨"ï¼Œæœ‰æ»‹å…»ã€æ©æ³½ä¹‹æ„
- **ç»„åˆå¯“æ„**ï¼šå®£æ‰¬ç¾å¾·ï¼Œæ¶¦æ³½ä»–äººï¼Œä½“ç°å›å­å“æ ¼

**å…¸ç±å‡ºå¤„**ï¼š
- è¯—ç»æ„è•´ï¼šä½“ç°"é£é›…"ä¼ ç»Ÿï¼Œç¬¦åˆç”·æ€§å–åä¹ ä¿—
- å„’å®¶ç†å¿µï¼šå®£ä¼ æ•™åŒ–ï¼Œæ¶¦ç‰©æ— å£°ï¼Œç¬¦åˆä»è€…å“æ ¼

---

## ğŸ“‹ è®¡ç®—å…¬å¼ä¸è¯„åˆ†æ ‡å‡†é™„å½•

### A. å…«å­—å››æŸ±è®¡ç®—æ–¹æ³•

```typescript
// å¹´æŸ±è®¡ç®— (ä»¥2025å¹´ä¸ºä¾‹)
å¹´ä»½ = 2025
å¹´æŸ±åºå· = (å¹´ä»½ - 3) % 60 = (2025 - 3) % 60 = 42
å¹´æŸ± = ç”²å­è¡¨[42] = "ä¹™å·³"

// æœˆæŸ±è®¡ç®— (ä»¥ä¹æœˆä¸ºä¾‹)  
æœˆæŸ±å¤©å¹² = (å¹´å¹²åºå· Ã— 2 + æœˆä»½) % 10
æœˆæŸ±åœ°æ”¯ = å›ºå®šåœ°æ”¯è¡¨[æœˆä»½]

// æ—¥æŸ±è®¡ç®— (éœ€è¦ä¸‡å¹´å†)
æ—¥æŸ± = ä¸‡å¹´å†æŸ¥è¯¢[å¹´æœˆæ—¥]

// æ—¶æŸ±è®¡ç®—
æ—¶æŸ±å¤©å¹² = (æ—¥å¹²åºå· Ã— 2 + æ—¶è¾°åºå·) % 10
æ—¶æŸ±åœ°æ”¯ = æ—¶è¾°å›ºå®šåœ°æ”¯
```

### B. ä¸‰æ‰äº”æ ¼è®¡ç®—å…¬å¼

```typescript
// åŸºç¡€å…¬å¼
å¤©æ ¼ = å§“æ°ç¬”ç”»å’Œ + 1 (å•å§“) æˆ– å§“æ°ç¬”ç”»å’Œ (å¤å§“)
äººæ ¼ = å§“æ°æœ«å­—ç¬”ç”» + åå­—é¦–å­—ç¬”ç”»
åœ°æ ¼ = åå­—ç¬”ç”»å’Œ (åŒå­—å) æˆ– åå­—ç¬”ç”» + 1 (å•å­—å)
å¤–æ ¼ = æ€»æ ¼ - äººæ ¼ + 1
æ€»æ ¼ = å§“åæ€»ç¬”ç”»æ•°

// äº”è¡Œå¯¹åº” (å°¾æ•°æ³•)
1,2 â†’ æœ¨    3,4 â†’ ç«    5,6 â†’ åœŸ    7,8 â†’ é‡‘    9,0 â†’ æ°´
```

### C. äº”è¡Œå–œç”¨ç¥åˆ†ææ ‡å‡†

```typescript
// æ—¥ä¸»å¼ºå¼±åˆ¤æ–­
å¼ºåŠ¿æ¡ä»¶: æœ¬æ°”æœ‰æ ¹ + å¾—æœˆä»¤ + åŒç±»å¤š
å¼±åŠ¿æ¡ä»¶: æœ¬æ°”æ— æ ¹ + å¤±æœˆä»¤ + åŒç±»å°‘

// ç”¨ç¥é€‰æ‹©åŸåˆ™
æ—¥ä¸»å¼º â†’ é€‰æ‹©å…‹æ³„è€—çš„äº”è¡Œä¸ºç”¨ç¥
æ—¥ä¸»å¼± â†’ é€‰æ‹©ç”Ÿæ‰¶çš„äº”è¡Œä¸ºç”¨ç¥
è°ƒå€™ç”¨ç¥ â†’ æ ¹æ®å­£èŠ‚è°ƒèŠ‚å¯’æš–ç‡¥æ¹¿
```

### D. è¯„åˆ†æƒé‡è®¾ç½®ä¾æ®

```typescript
// æƒé‡åˆ†é…åŸç†
ä¼ ç»Ÿå‘½ç†æ ¸å¿ƒ (50%):
  - ä¸‰æ‰äº”æ ¼: 25% (å§“åå­¦æ ¸å¿ƒ)
  - äº”è¡Œå¹³è¡¡: 25% (å…«å­—å‘½ç†æ ¸å¿ƒ)

ç°ä»£å–åè€ƒé‡ (30%):
  - éŸ³éŸµç¾æ„Ÿ: 20% (ç°ä»£é‡è§†ç¨‹åº¦é«˜)
  - å¤§è¡æ•°ç†: 10% (ä¼ ç»Ÿæ•°ç†å­¦)

æ–‡åŒ–ä¼ ç»Ÿå› ç´  (20%):
  - å¤§è¡æ•°ç†: 10% (81æ•°å‰å‡¶)
  - ç”Ÿè‚–é€‚å®œ: 10% (æ°‘ä¿—ä¼ ç»Ÿ)
```

---

## ğŸ“š æ•°æ®æŸ¥è¯¢æ¥å£è§„èŒƒ

### E. æ ¸å¿ƒæ•°æ®æ–‡ä»¶æ¥å£

#### 1. æƒå¨å­—ç¬¦æ•°æ®æŸ¥è¯¢ (ä¼˜å…ˆä½¿ç”¨)
```typescript
// ä¸»æ•°æ®æ–‡ä»¶: public/data/characters/final-enhanced-character-database.json
interface EnhancedCharacterData {
  [char: string]: {
    char: string;
    pinyin: string[];
    primaryPinyin: string;
    tone: number;
    strokes: {
      simplified: number;
      traditional: number;
      kangxi: number;
    };
    radical: string;
    wuxing: string;
    simplified: string;
    traditional: string;
    meanings: string[];
    isStandard: boolean;
  };
}

// ä¸»æŸ¥è¯¢æ¥å£
function getEnhancedCharacterData(char: string): EnhancedCharacterData[string] | null {
  const enhancedData = require('public/data/characters/final-enhanced-character-database.json');
  return enhancedData[char] || null;
}

// ä½¿ç”¨ç¤ºä¾‹
const wuData = getEnhancedCharacterData('å´');
/*
è¿”å›: {
  char: "å´",
  pinyin: ["wÃº"],
  primaryPinyin: "wÃº",
  tone: 2,
  strokes: { simplified: 7, traditional: 7, kangxi: 7 },
  radical: "å£",
  wuxing: "mu",
  simplified: "å´",
  traditional: "å³",
  meanings: ["è±¡å¤´çš„åŠ¨ä½œã€‚åˆèµ·æ¥è¡¨ç¤ºæ™ƒç€å¤´å¤§å£°è¯´è¯"],
  isStandard: true
}
*/
```

#### 2. Fallbackæ•°æ®æŸ¥è¯¢æ¥å£

##### 2.1 ç¬”ç”»æ•°æ®FallbackæŸ¥è¯¢
```typescript
// Fallbackæ–‡ä»¶: public/data/characters/real-stroke-data.json
function getCharacterStrokesFallback(char: string): number {
  const strokeData = require('public/data/characters/real-stroke-data.json');
  return strokeData.data[char]?.strokes || 0;
}
```

##### 2.2 äº”è¡Œæ•°æ®FallbackæŸ¥è¯¢
```typescript
// Fallbackæ–‡ä»¶: public/data/characters/wuxing_dict_jianti.json
function getCharacterWuxingFallback(char: string): string | null {
  const wuxingData = require('public/data/characters/wuxing_dict_jianti.json');
  
  for (const [element, strokeGroups] of Object.entries(wuxingData)) {
    for (const chars of Object.values(strokeGroups)) {
      if (chars.includes(char)) {
        return element; // è¿”å›: 'jin'|'mu'|'shui'|'huo'|'tu'
      }
    }
  }
  return null;
}
```

##### 2.3 æ‹¼éŸ³æ•°æ®FallbackæŸ¥è¯¢
```typescript
// Fallbackæ–‡ä»¶: public/data/configs/processed/pinyin-processed.json
function getCharacterPinyinFallback(char: string): {pinyin: string, tone: number} | null {
  const pinyinData = require('public/data/configs/processed/pinyin-processed.json');
  const result = pinyinData.data[char];
  return result ? {pinyin: result.pinyin, tone: result.tone} : null;
}
```

#### 3. ç™¾å®¶å§“æ’åæŸ¥è¯¢
```typescript
// æ•°æ®æ–‡ä»¶: public/data/names/baijiaxing.json
interface BaijiaxingData {
  title: string;
  paragraphs: string[];
}

// æŸ¥è¯¢æ¥å£
function getBaijiaxingRank(surname: string): number {
  const baijiaxingData = require('public/data/names/baijiaxing.json');
  
  let position = 0;
  for (const paragraph of baijiaxingData.paragraphs) {
    // ç§»é™¤æ ‡ç‚¹ç¬¦å·ï¼Œæå–å§“æ°
    const cleanText = paragraph.replace(/[ï¼Œã€‚]/g, '');
    for (const char of cleanText) {
      position++;
      if (char === surname) {
        return position;
      }
    }
  }
  return -1; // æœªæ‰¾åˆ°
}

// ä½¿ç”¨ç¤ºä¾‹
const wuRank = getBaijiaxingRank('å´'); // è¿”å›: 6
```

#### 4. ç»¼åˆå­—ç¬¦æ•°æ®æŸ¥è¯¢æ¥å£
```typescript
// æ™ºèƒ½æŸ¥è¯¢æ¥å£ (ä¼˜å…ˆä½¿ç”¨æƒå¨æ•°æ®åº“ï¼Œå¤±è´¥æ—¶è‡ªåŠ¨fallback)
function getCompleteCharacterInfo(char: string): CompleteCharacterInfo {
  // 1. ä¼˜å…ˆæŸ¥è¯¢æƒå¨æ•°æ®åº“
  const enhancedData = getEnhancedCharacterData(char);
  
  if (enhancedData) {
    return {
      char,
      traditional: enhancedData.traditional,
      simplified: enhancedData.simplified,
      pinyin: enhancedData.pinyin,
      primaryPinyin: enhancedData.primaryPinyin,
      tone: enhancedData.tone,
      strokes: {
        simplified: enhancedData.strokes.simplified,
        traditional: enhancedData.strokes.traditional,
        kangxi: enhancedData.strokes.kangxi
      },
      wuxing: enhancedData.wuxing,
      radical: enhancedData.radical,
      meanings: enhancedData.meanings,
      isStandard: enhancedData.isStandard,
      dataSource: 'enhanced-database',
      confidence: 1.0
    };
  }
  
  // 2. Fallbackåˆ°å…¶ä»–æ•°æ®æº
  const fallbackData = {
    char,
    traditional: char, // é»˜è®¤å€¼ï¼Œå¯èƒ½ä¸å‡†ç¡®
    simplified: char,
    pinyin: [],
    primaryPinyin: '',
    tone: 0,
    strokes: { simplified: 0, traditional: 0, kangxi: 0 },
    wuxing: '',
    radical: '',
    meanings: [],
    isStandard: false,
    dataSource: 'fallback',
    confidence: 0.5
  };
  
  // 2.1 è·å–æ‹¼éŸ³å’Œå£°è°ƒ
  const pinyinInfo = getCharacterPinyinFallback(char);
  if (pinyinInfo) {
    fallbackData.pinyin = [pinyinInfo.pinyin];
    fallbackData.primaryPinyin = pinyinInfo.pinyin;
    fallbackData.tone = pinyinInfo.tone;
    fallbackData.confidence += 0.2;
  }
  
  // 2.2 è·å–ç¬”ç”»
  const strokes = getCharacterStrokesFallback(char);
  if (strokes > 0) {
    fallbackData.strokes.simplified = strokes;
    fallbackData.strokes.traditional = strokes; // åº·ç†™å­—å…¸ç¬”ç”»
    fallbackData.strokes.kangxi = strokes;
    fallbackData.confidence += 0.2;
  }
  
  // 2.3 è·å–äº”è¡Œ
  const wuxing = getCharacterWuxingFallback(char);
  if (wuxing) {
    fallbackData.wuxing = wuxing;
    fallbackData.confidence += 0.1;
  }
  
  return fallbackData;
}

interface CompleteCharacterInfo {
  char: string;
  traditional: string;
  simplified: string;
  pinyin: string[];
  primaryPinyin: string;
  tone: number;
  strokes: {
    simplified: number;
    traditional: number;
    kangxi: number;
  };
  wuxing: string;
  radical: string;
  meanings: string[];
  isStandard: boolean;
  dataSource: 'enhanced-database' | 'fallback';
  confidence: number;
}
```

### F. SurnamePlugin é‡æ–°è®¾è®¡çš„å®Œæ•´å®ç°

```typescript
class SurnamePlugin {
  private enhancedData: EnhancedCharacterData;
  private strokeDataFallback: any;
  private wuxingDataFallback: any;
  private pinyinDataFallback: any;
  private baijiaxingData: BaijiaxingData;
  
  constructor() {
    // åŠ è½½ä¸»è¦æ•°æ®æ–‡ä»¶
    this.enhancedData = require('public/data/characters/final-enhanced-character-database.json');
    
    // åŠ è½½Fallbackæ•°æ®æ–‡ä»¶
    this.strokeDataFallback = require('public/data/characters/real-stroke-data.json');
    this.wuxingDataFallback = require('public/data/characters/wuxing_dict_jianti.json');
    this.pinyinDataFallback = require('public/data/configs/processed/pinyin-processed.json');
    this.baijiaxingData = require('public/data/names/baijiaxing.json');
  }
  
  async execute(input: SurnameInput): Promise<SurnameOutput> {
    const { familyName } = input;
    
    // 1. è·å–å®Œæ•´å­—ç¬¦ä¿¡æ¯ (æ™ºèƒ½æŸ¥è¯¢ï¼Œè‡ªåŠ¨fallback)
    const charInfo = this.getCompleteCharacterInfo(familyName);
    
    // 2. ç™¾å®¶å§“æ’åæŸ¥è¯¢
    const baijiaxingRank = this.getBaijiaxingRank(familyName);
    
    // 3. è®¡ç®—å¤©æ ¼åŸºæ•° (ä½¿ç”¨åº·ç†™å­—å…¸ç¬”ç”»)
    const tianGeBase = charInfo.strokes.kangxi + 1; // å•å§“è§„åˆ™
    
    // 4. åˆ¤æ–­å§“æ°ç±»å‹
    const isSingleChar = familyName.length === 1;
    const isCompoundSurname = familyName.length > 1;
    
    return {
      familyName,
      traditional: charInfo.traditional,
      simplified: charInfo.simplified,
      strokes: charInfo.strokes.simplified,
      strokesTraditional: charInfo.strokes.traditional,
      strokesKangxi: charInfo.strokes.kangxi,
      wuxing: charInfo.wuxing,
      pinyin: charInfo.pinyin,
      primaryPinyin: charInfo.primaryPinyin,
      tone: charInfo.tone,
      radical: charInfo.radical,
      meanings: charInfo.meanings,
      isSingleChar,
      isCompoundSurname,
      isStandard: charInfo.isStandard,
      baijiaxingRank: baijiaxingRank || -1,
      confidence: this.calculateConfidence(charInfo, baijiaxingRank),
      tianGeBase,
      dataSource: charInfo.dataSource
    };
  }
  
  private getCompleteCharacterInfo(char: string): CompleteCharacterInfo {
    // 1. ä¼˜å…ˆæŸ¥è¯¢æƒå¨æ•°æ®åº“
    const enhancedData = this.enhancedData[char];
    
    if (enhancedData && this.isValidEnhancedData(enhancedData)) {
      return {
        char,
        traditional: enhancedData.traditional || char,
        simplified: enhancedData.simplified || char,
        pinyin: enhancedData.pinyin || [],
        primaryPinyin: enhancedData.primaryPinyin || '',
        tone: enhancedData.tone || 0,
        strokes: {
          simplified: enhancedData.strokes?.simplified || 0,
          traditional: enhancedData.strokes?.traditional || 0,
          kangxi: enhancedData.strokes?.kangxi || 0
        },
        wuxing: enhancedData.wuxing || '',
        radical: enhancedData.radical || '',
        meanings: enhancedData.meanings || [],
        isStandard: enhancedData.isStandard || false,
        dataSource: 'enhanced-database',
        confidence: 1.0
      };
    }
    
    // 2. Fallbackåˆ°å…¶ä»–æ•°æ®æº
    return this.getFallbackCharacterInfo(char);
  }
  
  private isValidEnhancedData(data: any): boolean {
    return data && 
           data.strokes && 
           data.strokes.kangxi > 0 && 
           data.primaryPinyin && 
           data.wuxing;
  }
  
  private getFallbackCharacterInfo(char: string): CompleteCharacterInfo {
    const fallbackData: CompleteCharacterInfo = {
      char,
      traditional: char,
      simplified: char,
      pinyin: [],
      primaryPinyin: '',
      tone: 0,
      strokes: { simplified: 0, traditional: 0, kangxi: 0 },
      wuxing: '',
      radical: '',
      meanings: [],
      isStandard: false,
      dataSource: 'fallback',
      confidence: 0.3 // åŸºç¡€åˆ†
    };
    
    // 2.1 è·å–æ‹¼éŸ³å’Œå£°è°ƒ
    const pinyinInfo = this.getCharacterPinyinFallback(char);
    if (pinyinInfo) {
      fallbackData.pinyin = [pinyinInfo.pinyin];
      fallbackData.primaryPinyin = pinyinInfo.pinyin;
      fallbackData.tone = pinyinInfo.tone;
      fallbackData.confidence += 0.25;
    }
    
    // 2.2 è·å–ç¬”ç”» (åº·ç†™å­—å…¸ç¬”ç”»)
    const strokes = this.getCharacterStrokesFallback(char);
    if (strokes > 0) {
      fallbackData.strokes.simplified = strokes;
      fallbackData.strokes.traditional = strokes;
      fallbackData.strokes.kangxi = strokes;
      fallbackData.confidence += 0.25;
    }
    
    // 2.3 è·å–äº”è¡Œ
    const wuxing = this.getCharacterWuxingFallback(char);
    if (wuxing) {
      fallbackData.wuxing = wuxing;
      fallbackData.confidence += 0.2;
    }
    
    return fallbackData;
  }
  
  private getCharacterPinyinFallback(char: string): {pinyin: string, tone: number} | null {
    const result = this.pinyinDataFallback.data[char];
    return result ? {pinyin: result.pinyin, tone: result.tone} : null;
  }
  
  private getCharacterStrokesFallback(char: string): number {
    return this.strokeDataFallback.data[char]?.strokes || 0;
  }
  
  private getCharacterWuxingFallback(char: string): string | null {
    for (const [element, strokeGroups] of Object.entries(this.wuxingDataFallback)) {
      for (const chars of Object.values(strokeGroups)) {
        if (Array.isArray(chars) && chars.includes(char)) {
          return element;
        }
      }
    }
    return null;
  }
  
  private getBaijiaxingRank(surname: string): number {
    let position = 0;
    for (const paragraph of this.baijiaxingData.paragraphs) {
      const cleanText = paragraph.replace(/[ï¼Œã€‚]/g, '');
      for (const char of cleanText) {
        position++;
        if (char === surname) {
          return position;
        }
      }
    }
    return -1;
  }
  
  private calculateConfidence(charInfo: CompleteCharacterInfo, baijiaxingRank: number): number {
    let confidence = charInfo.confidence;
    
    // ç™¾å®¶å§“æ’ååŠ åˆ†
    if (baijiaxingRank > 0) {
      confidence = Math.min(confidence + 0.1, 1.0);
    }
    
    // æ•°æ®å®Œæ•´æ€§åŠ åˆ†
    if (charInfo.traditional && charInfo.traditional !== charInfo.char) {
      confidence = Math.min(confidence + 0.05, 1.0);
    }
    
    if (charInfo.meanings && charInfo.meanings.length > 0) {
      confidence = Math.min(confidence + 0.05, 1.0);
    }
    
    return Math.min(confidence, 1.0);
  }
}

// æ›´æ–°è¾“å‡ºæ¥å£
interface SurnameOutput {
  familyName: string;
  traditional: string;           // ğŸ†• ç¹ä½“å­—
  simplified: string;            // ğŸ†• ç®€ä½“å­—
  strokes: number;               // ç®€ä½“ç¬”ç”»
  strokesTraditional: number;    // ç¹ä½“ç¬”ç”»
  strokesKangxi: number;         // ğŸ†• åº·ç†™å­—å…¸ç¬”ç”» (ç”¨äºè®¡ç®—)
  wuxing: string;
  pinyin: string[];
  primaryPinyin: string;         // ğŸ†• ä¸»è¦æ‹¼éŸ³
  tone: number;
  radical: string;               // ğŸ†• éƒ¨é¦–
  meanings: string[];            // ğŸ†• å­—ä¹‰è§£é‡Š
  isSingleChar: boolean;
  isCompoundSurname: boolean;
  isStandard: boolean;           // ğŸ†• æ˜¯å¦æ ‡å‡†å­—
  baijiaxingRank: number;
  confidence: number;
  tianGeBase: number;
  dataSource: string;            // ğŸ†• æ•°æ®æ¥æº
}
```

### G. é‡æ–°è®¾è®¡çš„æ•°æ®æ–‡ä»¶ä¾èµ–æ€»ç»“

| æ’ä»¶ | ä¸»æ•°æ®æ–‡ä»¶ | Fallbackæ•°æ®æ–‡ä»¶ | ç”¨é€” |
|------|-----------|-----------------|------|
| **SurnamePlugin** | **final-enhanced-character-database.json** | real-stroke-data.json | æƒå¨å­—ç¬¦æ•°æ® + ç¬”ç”»Fallback |
| | | wuxing_dict_jianti.json | äº”è¡ŒFallback |
| | | pinyin-processed.json | æ‹¼éŸ³Fallback |
| | | baijiaxing.json | ç™¾å®¶å§“æ’å |
| **WuxingCharPlugin** | **final-enhanced-character-database.json** | wuxing_dict_jianti.json | äº”è¡Œå­—ç¬¦ç­›é€‰ |
| | | real-stroke-data.json | ç¬”ç”»ç­›é€‰ |
| **PhoneticPlugin** | **final-enhanced-character-database.json** | pinyin-processed.json | æ‹¼éŸ³éŸ³éŸµåˆ†æ |
| **StrokePlugin** | **final-enhanced-character-database.json** | real-stroke-data.json | ç¬”ç”»è®¡ç®— |
| **å…¶ä»–è¯„åˆ†æ’ä»¶** | **final-enhanced-character-database.json** | å„è‡ªç‰¹å®šæ–‡ä»¶ | ç»¼åˆå­—ç¬¦ä¿¡æ¯ |

### H. å…³é”®è®¾è®¡åŸåˆ™

#### 1. **æ•°æ®æºä¼˜å…ˆçº§**
```
1. final-enhanced-character-database.json (æœ€é«˜ä¼˜å…ˆçº§ï¼Œæƒå¨æ¥æº)
2. ä¸“ç”¨æ•°æ®æ–‡ä»¶ (å¦‚real-stroke-data.json)
3. å…¼å®¹æ€§æ•°æ®æ–‡ä»¶ (æœ€åfallback)
```

#### 2. **ç¬”ç”»ä½¿ç”¨è§„åˆ™**
```typescript
// é‡è¦ï¼šæ‰€æœ‰å‘½ç†è®¡ç®—éƒ½ä½¿ç”¨åº·ç†™å­—å…¸ç¬”ç”»
å¤©æ ¼è®¡ç®—: ä½¿ç”¨ strokes.kangxi
äººæ ¼è®¡ç®—: ä½¿ç”¨ strokes.kangxi  
åœ°æ ¼è®¡ç®—: ä½¿ç”¨ strokes.kangxi
æ€»æ ¼è®¡ç®—: ä½¿ç”¨ strokes.kangxi

// æ˜¾ç¤ºç”¨é€”å¯ä½¿ç”¨ç®€ä½“ç¬”ç”»
ç•Œé¢æ˜¾ç¤º: å¯é€‰æ‹© strokes.simplified
```

#### 3. **Fallbackæœºåˆ¶ä¿éšœ**
- **æ•°æ®å®Œæ•´æ€§**ï¼šç¡®ä¿å³ä½¿ä¸»æ•°æ®åº“ç¼ºå¤±æŸäº›ä¿¡æ¯ï¼Œç³»ç»Ÿä»èƒ½æ­£å¸¸è¿è¡Œ
- **ç½®ä¿¡åº¦è¯„ä¼°**ï¼šæ ¹æ®æ•°æ®æ¥æºè°ƒæ•´ç½®ä¿¡åº¦ï¼Œå½±å“æœ€ç»ˆæ¨èæƒé‡
- **é€æ˜åº¦**ï¼šæ˜ç¡®æ ‡æ³¨æ•°æ®æ¥æºï¼Œä¾¿äºè°ƒè¯•å’Œè´¨é‡æ§åˆ¶

#### 4. **æ–°å¢å­—æ®µè¯´æ˜**
- **traditional**: ç¹ä½“å­—å½¢ï¼Œç”¨äºä¼ ç»Ÿæ–‡åŒ–åˆ†æ
- **strokesKangxi**: åº·ç†™å­—å…¸ç¬”ç”»ï¼Œç”¨äºæ‰€æœ‰å‘½ç†è®¡ç®—
- **primaryPinyin**: ä¸»è¦è¯»éŸ³ï¼Œé¿å…å¤šéŸ³å­—å¹²æ‰°
- **radical**: éƒ¨é¦–ä¿¡æ¯ï¼Œç”¨äºç”Ÿè‚–ç”¨å­—åˆ†æ
- **meanings**: å­—ä¹‰è§£é‡Šï¼Œç”¨äºå¯“æ„åˆ†æ
- **dataSource**: æ•°æ®æ¥æºæ ‡è¯†ï¼Œç”¨äºè´¨é‡æ§åˆ¶

é€šè¿‡è¿™ç§**æƒå¨æ•°æ®åº“ä¼˜å…ˆ + æ™ºèƒ½Fallback**çš„è®¾è®¡ï¼Œç¡®ä¿äº†ç³»ç»Ÿæ—¢èƒ½è·å¾—æœ€é«˜è´¨é‡çš„æ•°æ®ï¼Œåˆå…·å¤‡è‰¯å¥½çš„å®¹é”™èƒ½åŠ›å’Œå‘åå…¼å®¹æ€§ã€‚

---

## ğŸ“š æ•°æ®æ¥æºè¯¦ç»†è¯´æ˜

### I. å„é¡¹æ•°æ®çš„æƒå¨æ¥æº

#### 1. **å§“æ°åŸºç¡€æ•°æ®**
**æ•°æ®æ¥æº**: `public/data/characters/final-enhanced-character-database.json`
**æƒå¨ä¾æ®**:
- **ç¬”ç”»æ•°**: åŸºäºåº·ç†™å­—å…¸ç¬”ç”»æ ‡å‡†
- **äº”è¡Œå±æ€§**: ä¼ ç»Ÿå‘½ç†å­¦äº”è¡Œå½’ç±»æ³•åˆ™
- **æ‹¼éŸ³å£°è°ƒ**: ç°ä»£æ±‰è¯­æ ‡å‡†å‘éŸ³
- **ç¹ç®€ä½“å¯¹ç…§**: Unicodeæ ‡å‡†å­—ç¬¦é›†
- **éƒ¨é¦–**: ã€Šè¯´æ–‡è§£å­—ã€‹åŠåº·ç†™å­—å…¸éƒ¨é¦–åˆ†ç±»

**å®é™…æŸ¥è¯¢éªŒè¯**:
```typescript
// æ–‡ä»¶ä½ç½®: ç¬¬17284-17303è¡Œ
"å´": {
  "strokes": {"simplified": 7, "traditional": 7, "kangxi": 7}, // âœ“ åº·ç†™å­—å…¸7ç”»
  "wuxing": "mu",                                               // âœ“ ä¼ ç»Ÿäº”è¡Œå½’æœ¨
  "primaryPinyin": "wÃº",                                        // âœ“ æ ‡å‡†è¯»éŸ³
  "tone": 2,                                                   // âœ“ é˜³å¹³å£°è°ƒ
  "traditional": "å³"                                           // âœ“ Unicodeç¹ä½“
}
```

#### 2. **ç™¾å®¶å§“æ’å**
**æ•°æ®æ¥æº**: `public/data/names/baijiaxing.json`
**æƒå¨ä¾æ®**: 
- ä¼ ç»Ÿã€Šç™¾å®¶å§“ã€‹æ–‡çŒ® (å®‹ä»£èµµé’±å­™ææ’åº)
- ç°ä»£å…¬å®‰éƒ¨æˆ·ç±ç»Ÿè®¡ (å®é™…äººå£åˆ†å¸ƒ)

**æŸ¥è¯¢éªŒè¯**:
```typescript
// æ–‡ä»¶ä½ç½®: ç¬¬6è¡Œ
"èµµé’±å­™æï¼Œå‘¨å´éƒ‘ç‹ã€‚"
// è®¡ç®—: èµµ(1) é’±(2) å­™(3) æ(4) å‘¨(5) å´(6) âœ“
```

#### 3. **å…«å­—å››æŸ±è®¡ç®—**
**æ•°æ®æ¥æº**: ä¼ ç»Ÿå†æ³•æ¨ç®— + ä¸‡å¹´å†å¯¹ç…§
**è®¡ç®—ä¾æ®**:
- **å¹²æ”¯çºªå¹´æ³•**: å…­åç”²å­å¾ªç¯ä½“ç³»
- **èŠ‚æ°”å†æ³•**: äºŒåå››èŠ‚æ°”åˆ’åˆ†æœˆä»¤
- **æ—¶è¾°ç³»ç»Ÿ**: åäºŒæ—¶è¾°å¯¹åº”åœ°æ”¯

**æ¨ç®—è¿‡ç¨‹éªŒè¯**:
```typescript
// 2025-10-31 10:00 å…«å­—æ¨ç®—
å¹´æŸ±: 2025å¹´ = ç”²å­çºªå¹´ç¬¬42å¹´ = ä¹™å·³å¹´  âœ“
æœˆæŸ±: å†œå†ä¹æœˆ = æˆŒæœˆï¼Œä¹™å¹´ä¸™æœˆ = ä¸™æˆŒæœˆ  âœ“  
æ—¥æŸ±: éœ€ä¸‡å¹´å†æŸ¥è¯¢ = æˆŠå­æ—¥ (ç¤ºä¾‹)  âš ï¸
æ—¶æŸ±: å·³æ—¶(9-11ç‚¹) + æˆŠæ—¥ = ä¸å·³æ—¶  âœ“
```

#### 4. **äº”è¡Œå–œç”¨ç¥åˆ†æ**
**ç†è®ºä¾æ®**: ä¼ ç»Ÿå‘½ç†å­¦æ‰¶æŠ‘ç”¨ç¥æ³•
**åˆ†æåŸç†**:
```typescript
å…«å­—: ä¹™å·³ ä¸™æˆŒ æˆŠå­ ä¸å·³
äº”è¡Œç»Ÿè®¡: æœ¨1 ç«4 åœŸ2 é‡‘0 æ°´1
æ—¥ä¸»åˆ†æ: æˆŠåœŸç”ŸäºæˆŒæœˆ(åœŸæ—º) + ç«å¤š = ç‡¥çƒ­åå¼º
ç”¨ç¥æ¨æ–­: éœ€é‡‘æ°´è°ƒå€™æ¶¦ç‡¥  âœ“ ç¬¦åˆä¼ ç»Ÿç†è®º
```

#### 5. **ç”Ÿè‚–ç”¨å­—è§„å¾‹**
**ç†è®ºä¾æ®**: ä¼ ç»Ÿç”Ÿè‚–è±¡å¾å­¦ + åŠ¨ç‰©ä¹ æ€§è”æƒ³
**è›‡å¹´ç”¨å­—åŸç†**:
```typescript
ç”Ÿè‚–ç‰¹å¾: æ –æ¯æ´ç©´ã€å¤œè¡Œã€å†·è¡€åŠ¨ç‰©
å–œç”¨æ¨ç†:
- æ´ç©´å±…ä½ â†’ å–œ"å£"ã€"å®€"å­—æ ¹  âœ“ ä¼ ç»Ÿç†è®º
- é¿æ—¥å…‰æš´æ™’ â†’ å¿Œ"æ—¥"ã€"å…‰"å­—æ ¹  âœ“ ä¹ æ€§è”æƒ³
- æ ‘æ—æ –æ¯ â†’ å–œ"æœ¨"ã€"æ—"å­—æ ¹  âœ“ ç¯å¢ƒåå¥½
```

#### 6. **ä¸‰æ‰äº”æ ¼è®¡ç®—**
**ç†è®ºä¾æ®**: æ—¥æœ¬ä¼ å…¥çš„å§“åå­¦æ•°ç†åˆ†ææ³•
**è®¡ç®—å…¬å¼éªŒè¯**:
```typescript
// å´(7ç”») + å®£(9ç”») + æ¶¦(16ç”»)
å¤©æ ¼: 7 + 1 = 8        âœ“ å•å§“è§„åˆ™
äººæ ¼: 7 + 9 = 16       âœ“ å§“+åé¦–å­—
åœ°æ ¼: 9 + 16 = 25      âœ“ åå­—ä¸¤å­—å’Œ
å¤–æ ¼: 32 - 16 + 1 = 17 âœ“ æ ‡å‡†å…¬å¼
æ€»æ ¼: 7 + 9 + 16 = 32  âœ“ å…¨éƒ¨ç¬”ç”»å’Œ
```

### J. æ•°æ®éªŒè¯æ–¹æ³•

#### 1. **äº¤å‰éªŒè¯æœºåˆ¶**
```typescript
// å¤šæ•°æ®æºäº¤å‰éªŒè¯
ä¸»æ•°æ®æº: final-enhanced-character-database.json
éªŒè¯æº1: real-stroke-data.json (ç¬”ç”»éªŒè¯)
éªŒè¯æº2: wuxing_dict_jianti.json (äº”è¡ŒéªŒè¯)  
éªŒè¯æº3: pinyin-processed.json (æ‹¼éŸ³éªŒè¯)

// ä¸€è‡´æ€§æ£€æŸ¥
if (ä¸»æ•°æ® !== éªŒè¯æ•°æ®) {
  è®°å½•å·®å¼‚å¹¶é€‰æ‹©æ›´å¯é çš„æ¥æº;
  è°ƒæ•´ç½®ä¿¡åº¦è¯„åˆ†;
}
```

#### 2. **ç½®ä¿¡åº¦è¯„ä¼°æ ‡å‡†**
```typescript
ç½®ä¿¡åº¦è®¡ç®—:
- enhanced-databaseå‘½ä¸­: 1.0 (æœ€é«˜å¯ä¿¡åº¦)
- å¤šæºæ•°æ®ä¸€è‡´: +0.1 
- ç™¾å®¶å§“æ”¶å½•: +0.1
- å®Œæ•´å­—ä¹‰ä¿¡æ¯: +0.05
- ç¹ç®€ä½“å¯¹ç…§: +0.05
```

### K. æ½œåœ¨æ•°æ®é£é™©ä¸å¤„ç†

#### 1. **å·²çŸ¥é™åˆ¶**
- **æ—¥æŸ±è®¡ç®—**: éœ€è¦ç²¾ç¡®ä¸‡å¹´å†å¯¹ç…§ï¼Œç¤ºä¾‹ä¸­ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®
- **åœ°åŸŸå·®å¼‚**: éƒ¨åˆ†æ‹¼éŸ³åœ¨æ–¹è¨€åŒºå¯èƒ½æœ‰å·®å¼‚
- **ç‰ˆæœ¬æ›´æ–°**: æ•°æ®åº“å¯èƒ½å­˜åœ¨å†å²ç‰ˆæœ¬å·®å¼‚

#### 2. **é£é™©ç¼“è§£æªæ–½**
- **Fallbackæœºåˆ¶**: å¤šå±‚æ•°æ®æºä¿éšœ
- **ç½®ä¿¡åº¦æ ‡è®°**: æ˜ç¡®æ•°æ®å¯é æ€§
- **æ¥æºè¿½æº¯**: è®°å½•æ¯é¡¹æ•°æ®çš„å…·ä½“æ¥æº
- **å®šæœŸéªŒè¯**: ä¸æƒå¨å­—å…¸å®šæœŸæ¯”å¯¹æ›´æ–°

---

## ğŸ¯ **æ’ä»¶è¾“å‡ºå†…å®¹çš„æ ¸å¿ƒä½œç”¨åˆ†æ**

æ‚¨é—®åˆ°è¿™äº›è¾“å‡ºå†…å®¹çš„ä½œç”¨ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸å…³é”®çš„é—®é¢˜ã€‚è®©æˆ‘è¯¦ç»†è¯´æ˜ **GenderPlugin** å’Œ **BirthTimePlugin** è¾“å‡ºå†…å®¹åœ¨æ•´ä¸ªå–åç³»ç»Ÿä¸­çš„é‡è¦ä½œç”¨ï¼š

### **ğŸ”— ç®€åŒ–åçš„æ•°æ®æµè½¬å…³ç³»å›¾**
```
Layer 1: åŸºç¡€ä¿¡æ¯å±‚
â”œâ”€â”€ SurnamePlugin â†’ [å§“æ°åŸºç¡€å±æ€§] â†’ Layer 4 WuxingCharPlugin, Layer 6 SancaiScoringPlugin
â”œâ”€â”€ GenderPlugin â†’ [å…¸ç±ä¼˜å…ˆçº§ + å­—ç¬¦è¿‡æ»¤åå¥½] â†’ Layer 4 å­—ç¬¦ç­›é€‰æ’ä»¶  
â””â”€â”€ BirthTimePlugin â†’ [æ—¶é—´å‘½ç†æ•°æ®] â†’ Layer 2 æ‰€æœ‰å‘½ç†åˆ†ææ’ä»¶

Layer 2: å‘½ç†åˆ†æå±‚ (ä¾èµ– Layer 1 è¾“å‡º)
â”œâ”€â”€ BaziPlugin (ä¾èµ– BirthTimePlugin å†œå†+æ—¶è¾°æ•°æ®)
â”œâ”€â”€ WuxingPlugin (ä¾èµ– BirthTimePlugin èŠ‚æ°”+å¹²æ”¯æ•°æ®)
â””â”€â”€ ZodiacPlugin (ä¾èµ– BirthTimePlugin ç”Ÿè‚–æ•°æ®)

Layer 3: é€‰å­—ç­–ç•¥å±‚ (ä¾èµ– Layer 1+2 è¾“å‡º)
â””â”€â”€ ç­–ç•¥æ’ä»¶ä½¿ç”¨å‘½ç†åˆ†æç»“æœï¼Œæ— éœ€å¤æ‚çš„æ€§åˆ«åå¥½é…ç½®

Layer 4: å­—ç¬¦ç­›é€‰å±‚ (ä¾èµ–å‰é¢æ‰€æœ‰è¾“å‡º)
â”œâ”€â”€ WuxingCharPlugin (ä½¿ç”¨ GenderPlugin.characterFilter)
â”œâ”€â”€ StrokePlugin (è€ƒè™‘æ€§åˆ«é€‚å®œæ€§)
â”œâ”€â”€ PhoneticPlugin (åº”ç”¨æ€§åˆ«è¯»éŸ³åå¥½)
â””â”€â”€ PoetryPlugin (ä½¿ç”¨ GenderPlugin.literarySourcePriority)

Layer 5-6: åå­—ç”Ÿæˆå’Œè¯„åˆ†å±‚
```

### **ğŸ“Š GenderPlugin ç®€åŒ–è¾“å‡ºä½œç”¨è¯¦è§£**

#### **1. literarySourcePriority (å…¸ç±æ¥æºæƒé‡)**
```typescript
ä½œç”¨ç›®æ ‡: Layer 4 PoetryPlugin (å¦‚æœå­˜åœ¨)
å…·ä½“åº”ç”¨:
  - è·å–æ€§åˆ«åå¥½: context.genderInfo.literarySourcePriority
  - é€‰æ‹©æœ€é«˜ä¼˜å…ˆçº§å…¸ç±: "æ¥šè¾" (0.9) ä¸ºç”·æ€§é¦–é€‰
  - ä»å¯¹åº”å…¸ç±ä¸­æå–å­—ç¬¦: extractCharactersFromSource("æ¥šè¾")
  
å½±å“ç»“æœ: åå­—å…·æœ‰æ·±åšçš„æ–‡åŒ–åº•è•´å’Œæ­£ç¡®çš„æ€§åˆ«é€‚é…å…¸ç±ç‰¹è‰²
```

#### **2. characterFilter (å­—ç¬¦è¿‡æ»¤åå¥½)**
```typescript
ä½œç”¨ç›®æ ‡: Layer 4 å­—ç¬¦ç­›é€‰å±‚æ’ä»¶
å…·ä½“åº”ç”¨:
  - WuxingCharPlugin: åº”ç”¨æ€§åˆ«è¿‡æ»¤è§„åˆ™
    * preferMasculine: true â†’ ä¼˜å…ˆé€‰æ‹©é˜³åˆšç‰¹è´¨å­—ç¬¦
    * avoidFeminine: true â†’ é¿å…è¿‡äºæŸ”ç¾çš„å­—ç¬¦
    * culturalDepth: 0.9 â†’ æé«˜æ–‡åŒ–å†…æ¶µå­—ç¬¦æƒé‡
  
  - StrokePlugin: åœ¨ç¬”ç”»ç­›é€‰æ—¶è€ƒè™‘æ€§åˆ«é€‚å®œæ€§
  - PhoneticPlugin: è°ƒæ•´è¯»éŸ³çš„æ€§åˆ«å€¾å‘æ€§è¯„ä¼°
  
å½±å“ç»“æœ: ç¡®ä¿é€‰å‡ºçš„å­—ç¬¦ç¬¦åˆç”·æ€§æ–‡åŒ–ç‰¹å¾ï¼Œé¿å…æ€§åˆ«ç‰¹å¾æ··æ·†
```

### **â° BirthTimePlugin è¾“å‡ºä½œç”¨è¯¦è§£**

#### **1. å†œå†ä¿¡æ¯ (lunar)**
```typescript
ä½œç”¨ç›®æ ‡: Layer 2 BaziPlugin
å…·ä½“åº”ç”¨:
  - year: 2025, month: 9, day: 9 â†’ è®¡ç®—å‡†ç¡®çš„å…«å­—å››æŸ±
  - å†œå†ä¹æœˆåˆä¹ â†’ ç¡®å®šæ—¥æŸ±å¹²æ”¯
  
å½±å“ç»“æœ: å…«å­—åˆ†æçš„å‡†ç¡®æ€§ï¼Œç›´æ¥å½±å“äº”è¡Œå¹³è¡¡åˆ¤æ–­
```

#### **2. å¹²æ”¯çºªå¹´ (ganZhi)**
```typescript
ä½œç”¨ç›®æ ‡: Layer 2 WuxingPlugin, BaziPlugin
å…·ä½“åº”ç”¨:
  - "ä¹™å·³å¹´" â†’ ä¹™æœ¨å·³ç«ï¼Œå¹´æŸ±äº”è¡Œå±æ€§
  - ä¸æœˆæ—¥æ—¶æŸ±ç»„åˆ â†’ å®Œæ•´çš„å››æŸ±å…«å­—ä½“ç³»
  
å½±å“ç»“æœ: ç²¾ç¡®çš„äº”è¡Œæ—ºè¡°åˆ†æï¼ŒæŒ‡å¯¼è¡¥ç›Šäº”è¡Œçš„é€‰å­—æ–¹å‘
```

#### **3. ç”Ÿè‚–ä¿¡æ¯ (zodiac)**
```typescript
ä½œç”¨ç›®æ ‡: Layer 2 ZodiacPlugin
å…·ä½“åº”ç”¨:
  - "è›‡" â†’ ç”Ÿè‚–è›‡çš„å–œå¿Œç”¨å­—åˆ†æ
  - è›‡å–œ"å£"ã€"å®€"ã€"æœ¨"ç­‰åæ—
  - è›‡å¿Œ"è™"ã€"çŒª"ç­‰å†²å…‹å­—ç¬¦
  
å½±å“ç»“æœ: åŸºäºç”Ÿè‚–ç‰¹å¾çš„å­—ç¬¦ç­›é€‰ï¼Œå¢å¼ºå‘½ç†åŒ¹é…åº¦
```

#### **4. èŠ‚æ°”å­£èŠ‚ (season)**
```typescript
ä½œç”¨ç›®æ ‡: Layer 2 WuxingPlugin
å…·ä½“åº”ç”¨:
  - æ·±ç§‹ + "é‡‘æ—ºåœŸç›¸æœ¨ä¼‘ç«å›šæ°´æ­»" â†’ äº”è¡Œæ—ºè¡°çŠ¶æ€
  - æŒ‡å¯¼äº”è¡Œè¡¥ç›Šæ–¹å‘ (éœ€è¦è¡¥æœ¨ç«ï¼Œå¿Œè®³è¿‡å¤šé‡‘åœŸ)
  
å½±å“ç»“æœ: å­£èŠ‚æ€§äº”è¡Œè°ƒèŠ‚ï¼Œç¡®ä¿å‘½ç†å¹³è¡¡
```

#### **5. æ—¶è¾°åˆ†æ (timeAnalysis)**
```typescript
ä½œç”¨ç›®æ ‡: Layer 2 BaziPlugin, WuxingPlugin
å…·ä½“åº”ç”¨:
  - å·³æ—¶ + ç«å…ƒç´  + "é˜³æ°”æ—ºç››" â†’ æ—¶æŸ±å±æ€§ç¡®å®š
  - å½±å“æ•´ä½“å…«å­—çš„äº”è¡Œå¹³è¡¡è®¡ç®—
  
å½±å“ç»“æœ: æ—¶è¾°ç²¾ç¡®åº¦ç›´æ¥å½±å“å‘½ç†åˆ†æçš„æ·±åº¦å’Œå‡†ç¡®æ€§
```

#### **6. ç¡®å®šæ€§ç­‰çº§ (certaintyLevel)**
```typescript
ä½œç”¨ç›®æ ‡: æ•´ä¸ªæ’ä»¶ç³»ç»Ÿçš„æ‰§è¡Œç­–ç•¥
å…·ä½“åº”ç”¨:
  - Level 1 (å®Œå…¨ç¡®å®š) â†’ å¯ç”¨æ‰€æœ‰å‘½ç†åˆ†ææ’ä»¶
  - Level 2 (éƒ¨åˆ†ç¡®å®š) â†’ å¯ç”¨ç®€åŒ–ç‰ˆåˆ†æ
  - Level 3+ â†’ é™çº§ä¸ºåŸºç¡€åˆ†æ
  
å½±å“ç»“æœ: åŠ¨æ€è°ƒæ•´åˆ†ææ·±åº¦ï¼Œç¡®ä¿ç»“æœå¯é æ€§
```

### **ğŸš¨ ç¼ºå¤±è¾“å‡ºçš„ä¸¥é‡åæœ**

#### **å¦‚æœ GenderPlugin è¾“å‡ºç¼ºå¤±ï¼š**
- âŒ **å…¸ç±é€‰æ‹©å¤±å»æ–¹å‘**ï¼šæ— æ³•ä½“ç°"ç”·æ¥šè¾å¥³è¯—ç»"ä¼ ç»Ÿ
- âŒ **æ€§åˆ«ç‰¹å¾æ··æ·†**ï¼šå¯èƒ½å‡ºç°"ç”·å­©å–å¥³æ€§åŒ–åå­—"çš„é—®é¢˜  
- âŒ **å­—ç¬¦ç­›é€‰å¤±æ•ˆ**ï¼šæ— æ³•åº”ç”¨æ€§åˆ«é€‚å®œæ€§è¿‡æ»¤è§„åˆ™

#### **å¦‚æœ BirthTimePlugin è¾“å‡ºç¼ºå¤±ï¼š**
- âŒ **å‘½ç†åˆ†æå…¨é¢å¤±æ•ˆ**ï¼šBaziPluginã€WuxingPluginã€ZodiacPlugin æ— æ³•æ­£å¸¸å·¥ä½œ
- âŒ **äº”è¡Œå¹³è¡¡åˆ¤æ–­é”™è¯¯**ï¼šæ— æ³•å‡†ç¡®è¡¥ç›Šæ‰€éœ€äº”è¡Œ
- âŒ **ç”Ÿè‚–åˆ†æç¼ºå¤±**ï¼šå¤±å»é‡è¦çš„é€‰å­—ä¾æ®
- âŒ **æ•´ä¸ªå‘½ç†ä½“ç³»å´©å¡Œ**ï¼šå–åæ²¦ä¸ºéšæœºç»„åˆ

### **ğŸ’¡ ç®€åŒ–è®¾è®¡çš„æ ¸å¿ƒä»·å€¼**

ç»è¿‡ç®€åŒ–åï¼Œè¿™ä¸¤ä¸ªæ’ä»¶çš„è¾“å‡ºæ›´åŠ ç²¾å‡†å’Œå®ç”¨ï¼š

**GenderPluginï¼ˆç®€åŒ–ç‰ˆï¼‰**ï¼š
- âœ… **å…¸ç±ä¼˜å…ˆçº§æ˜ç¡®**ï¼šç›´æ¥æ”¯æŒ"ç”·æ¥šè¾å¥³è¯—ç»"ä¼ ç»Ÿ
- âœ… **å­—ç¬¦è¿‡æ»¤å®ç”¨**ï¼špreferMasculine/avoidFeminine ç­‰è§„åˆ™å¯ç›´æ¥åº”ç”¨
- âœ… **é¿å…è¿‡åº¦è®¾è®¡**ï¼šå»é™¤äº†æ— æ³•å®ç°çš„å¤æ‚è¯­ä¹‰åˆ†æ

**BirthTimePluginï¼ˆä¿æŒåŸæœ‰è®¾è®¡ï¼‰**ï¼š
- âœ… **å‘½ç†æ•°æ®å®Œæ•´**ï¼šä¸ºå…«å­—ã€äº”è¡Œã€ç”Ÿè‚–åˆ†ææä¾›ç²¾ç¡®åŸºç¡€
- âœ… **æ—¶é—´è½¬æ¢å‡†ç¡®**ï¼šå…¬å†å†œå†å¹²æ”¯å†çš„å¯é è½¬æ¢
- âœ… **ç¡®å®šæ€§ç­‰çº§**ï¼šåŠ¨æ€è°ƒæ•´åˆ†ææ·±åº¦

**æ•´ä½“æ•ˆæœ**ï¼š
1. **å®ç”¨æ€§æ›´å¼º** - æ¯ä¸ªè¾“å‡ºéƒ½æœ‰æ˜ç¡®çš„ä½¿ç”¨åœºæ™¯
2. **å®ç°éš¾åº¦é™ä½** - é¿å…äº†å¤æ‚çš„è¯­ä¹‰åˆ†æå’Œæ–‡åŒ–ç‰¹è´¨åŒ¹é…
3. **ç³»ç»Ÿç¨³å®šæ€§æé«˜** - ç®€åŒ–çš„é…ç½®å‡å°‘äº†å‡ºé”™å¯èƒ½æ€§
4. **æ–‡åŒ–ä¼ ç»Ÿä¿æŒ** - æ ¸å¿ƒçš„æ€§åˆ«é€‰å­—åŸåˆ™å¾—åˆ°æ­£ç¡®ä½“ç°

**è¿™æ ·çš„ç®€åŒ–è®¾è®¡æ—¢ä¿æŒäº†å–åç³»ç»Ÿçš„æ–‡åŒ–å†…æ¶µï¼Œåˆç¡®ä¿äº†æŠ€æœ¯å®ç°çš„å¯è¡Œæ€§ã€‚**

---

*æ–‡æ¡£ç”Ÿæˆæ—¶é—´ï¼š2024-12-19*  
*ç¤ºä¾‹è®¡ç®—ï¼šå´å§“ç”·å­©ï¼Œ2025-10-31 10:00å‡ºç”Ÿ*  
*æœ€ç»ˆæ¨èï¼šå´å®£æ¶¦ (89.2åˆ†ï¼Œä¼˜ç§€ç­‰çº§)*  
*è®¡ç®—æ’ä»¶ï¼šå…­å±‚æ¶æ„ï¼Œ17ä¸ªæ’ä»¶å®Œæ•´æ‰§è¡Œ*  
*æ•°æ®æŸ¥è¯¢ï¼šåŸºäºå®é™…JSONæ•°æ®æ–‡ä»¶çš„æ ‡å‡†æŸ¥è¯¢æ¥å£*  
*æ•°æ®æ¥æºï¼šæƒå¨å­—å…¸ + ä¼ ç»Ÿå‘½ç†å­¦ + ç°ä»£ç»Ÿè®¡å­¦*
